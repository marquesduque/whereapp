controller.formulario={init:function(n,t){t.id==null&&(t.id=controller.login.get().id);creait.get("formulario",{id:t.id},function(i){n({grupos:i},function(){$("[pergunta_id] input").change(function(){creait.post("formulario",{pergunta_id:$(this).closest("[pergunta_id]").attr("pergunta_id"),valor:$(this).is(":checked")?"Sim":"Não",pessoa_id:t.id,autor_id:controller.login.get().id},function(){creait.loader(!1)});creait.loader(!1)})})})},get:function(){return window.localStorage.cartao==null?null:JSON.parse(window.localStorage.cartao)},set:function(n){window.localStorage.cartao=n==null?n:JSON.stringify(n)}};controller.acompanhamento={init:function(n,t){var r=controller.login.get(),i=t.compra_id;creait.get("acompanhamento?id="+i,null,function(t){n(t,function(){if(setInterval(function(){$(".page-on-center").attr("loader","false");myApp.mainView.refreshPage()},12e4),t.cancelamento!=null?$(".bg-acompanhamento").html('<div class="label_status">PEDIDO<br>CANCELADO<\/div>'):(t.preparo!=null?($("#pedido_recebido").html(t.recebido.toString().substring(16,11)),$($("#pedido_recebido").parent().find("div")[0]).addClass("acompanhamento-success"),$($("#saiu_para_entrega").parent().find("div")[0]).addClass("acompanhamento-warning")):($("#pedido_recebido").parent().hide(),$("#saiu_para_entrega").parent().hide(),$("#pedido_entregue").parent().hide()),t.finalizado!=null?($(".label_status").html("PEDIDO<br>CONFIRMADO"),$("#saiu_para_entrega").html(t.preparo.toString().substring(16,11)),$($("#saiu_para_entrega").parent().find("div")[0]).removeClass("acompanhamento-warning"),$($("#saiu_para_entrega").parent().find("div")[0]).addClass("acompanhamento-success"),$($("#pedido_entregue").parent().find("div")[0]).addClass("acompanhamento-warning")):$("#pedido_entregue").parent().hide(),t.entregue!=null&&($("#pedido_entregue").html(t.finalizado.toString().substring(16,11)),$($("#pedido_entregue").parent().find("div")[0]).removeClass("acompanhamento-warning"),$($("#pedido_entregue").parent().find("div")[0]).addClass("acompanhamento-success"))),t.valor_frete!=null&&(t.total=t.total+t.valor_frete),$("#total_acompanhamento").html(t.total.formatMoney(2)),$("#repetir_pedido").click(function(){controller.carrinho.set(null);var n={produtos:[]};$(t.pedido).each(function(t,i){var r,u;r={montagem_id:null,produtos:[]};adicionar_value=i.produto;adicionar_value.montagens=[];adicionar_value.icone="/api/produto?produto_id="+adicionar_value.id;u=i.preco;$(adicionar_value.complemento).each(function(n,t){t.selecionado=!0;t.selecionado==!0&&(t.preco==null&&(t.preco=0),adicionar_value.agrupamento==null&&(adicionar_value.agrupamento="",adicionar_value.agrupamentoid=""),adicionar_value.agrupamento+=" + "+t.produto.nome,adicionar_value.agrupamentoid+=t.id+",",adicionar_value.redirect_adicionar="montagem",u+=t.preco,r.produtos.push({preco:t.produto.preco,produto_id:t.id,external_id:t.external_id,nome:t.nome}));t.selecionado=!1});adicionar_value.complemento.length==0&&(adicionar_value.agrupamento=adicionar_value.descricao);r.produtos.length>0&&adicionar_value.montagens.push(r);adicionar_value.nome=i.produto.nome;adicionar_value.agenda_id=[];adicionar_value.quantidade=1;adicionar_value.valor=i.preco.formatMoney(2);adicionar_value.total=u.formatMoney(2);adicionar_value.preco=i.preco;adicionar_value.produto_id=i.id;n.produtos.push(adicionar_value);controller.carrinho.set(n)});creait.redirect("carrinho")}),t.horario=t.horario[0],t.horario.numero==null){$("#endereco").html("PRODUTO RETIRADO NA LOJA");$("#pedido_entregue").closest(".col-33").hide();var n=$(".bg-acompanhamento .col-33");n.removeClass("col-33");n.addClass("col-50");$(n[1]).find(".label-acompanhamento").text("FINALIZADO");$(".iconecommerce-truck-4").removeClass(".iconecommerce-truck-4").addClass("iconecommerce-box");$(n[1]).find(".acompanhamento-line").hide()}else $("#endereco").html('<i class="flaticon-location-pin"><\/i>  '+t.horario.endereco+(t.horario.numero==null?"":", "+t.horario.numero)+(t.horario.complemento==null?"":" - "+t.horario.complemento)+" - Frete: "+(t.valor_frete==null||t.valor_frete==0?"Grátis":t.valor_frete.formatMoney(2)));t.horario.agenda_id!=null&&($(".transportando").html("ATENDIMENTO"),$(".entregue").html("FINALIZADO"),$(".iconecommerce-truck-4").removeClass("iconecommerce-truck-4").removeClass("glyph-icon").addClass("icon-user-check"),$(".iconecommerce-box").removeClass("iconecommerce-box").removeClass("glyph-icon").addClass("icon-aid-kit"));$("#pedido").html(t.horario.hora_date+'<br><span style="font-size:12px;    letter-spacing: 2.7px;">PEDIDO '+i+"<\/span>")})})}};controller.adicionar={init:function(n,t){function r(){adicionar_produto_memoria(t);var n=controller.adicionar.get();n.quantidade==null&&(n.quantidade=1);n.total=(n.quantidade*n.preco).formatMoney(2);controller.login.get()!=null&&controller.login.get().perfil_id==5&&n.id!=null?creait.get("estoque?pessoa_id="+controller.login.get().id+"&produto_id="+n.id,null,function(t){u(n,t)}):u(n,null)}function u(t,i){t.redirect_id=t.redirect_adicionar=="montagem"?t.id:t.categoria_id;t.estoque=i!=null&&i.length>0?i[0].quantidade:null;t.periodo!=null&&(t.periodo=t.periodo.split(","));n(t,function(){function n(){var n,i;creait.loader(!0);t.agenda_id!=null&&t.agenda_id>0&&(t.data=$("#demo-calendar-disabled").val().split(", ")[1]+" "+$(".tag_hora.active").text()+":00",t.agrupamentoid=t.data,t.agrupamento="Dia: "+$("#demo-calendar-disabled").val().split(", ")[1]+"<br>HORÁRIO: das "+$(".tag_hora.active").text());controller.carrinho.get()==null?(t.total=(t.preco*t.quantidade).formatMoney(2),t.observacao=$("#observacao").val(),t.comanda=$("#comanda").val(),n={produtos:[]},n.produtos.push(t),controller.carrinho.set(n)):(n=controller.carrinho.get(),i=$(n.produtos).filter(function(n,i){return(t.unidade==null||t.unidade=="")&&i.id==parseInt(t.id,10)&&i.agrupamentoid==t.agrupamentoid&&i.comanda==$("#comanda").val()})[0],t.observacao=$("#observacao").val(),t.comanda=$("#comanda").val(),t.unidade==null||t.unidade==""?i!=null?(i.quantidade=i.quantidade+t.quantidade,i.total=(i.quantidade*i.preco).formatMoney(2)):(t.total=(t.preco*t.quantidade).formatMoney(2),n.produtos.push(t)):(t.total=(t.preco*creait.convert_int_peso(t.quantidade)).formatMoney(2),n.produtos.push(t)),controller.carrinho.set(n));controller.comanda.set({comanda:t.comanda,mesa:controller.login.get()==null?"":controller.login.get().cpf})}controller.login.get()!=null&&controller.login.get().perfil_id==6?$("#fechar").remove():$("#btn_edit").remove();t.montagem==null&&$("#fechar").remove();$(".og_url").attr("content",window.location.href);$(".og_title").attr("content",t.nome);$(".og_description").attr("content",t.descricao);$(".og_image").attr("content",t.icone);controller.login.get()!=null&&controller.comanda.get()!=null&&controller.login.get().perfil_id==5&&controller.comanda.get().mesa==controller.login.get().cpf&&$("#comanda").val(controller.comanda.get().comanda);$("#comanda").focus(function(){$(this).val("")});t.agenda_id!=null&&t.agenda_id>0&&creait.get("horarios",{agenda_id:t.agenda_id},function(n){var i=new Date,r,u;i.setDate(i.getDate()+1);creait.loader(!1);r=[];r.push(i);u=myApp.calendar({input:"#demo-calendar-disabled",dateFormat:"Agendar para DD, dd/mm/yyyy",closeOnSelect:!0,toolbarCloseText:"AGENDAR",dayNames:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sabado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],weekHeader:!0,monthNames:["Janeiro","Fevereiro","Marco","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Deze"],minDate:new Date,maxDate:(new Date).addMinutes(129600),value:r,onOpen:function(){},onChange:function(i,r){var o,f;if(i.opened==!0||i.container==null){var h=["dom","seg","ter","qua","qui","sex","sab"],e=h[r[0].getDay()],u=t.duracao;u!=null&&u!=0?($(".periodo").html("Periodo<br>"+u+" min"),$("#periodo").val(u)):(u=parseInt($($(".tag_periodo")[0]).attr("periodo"),10),$(".periodo").html("Periodo<br>"+u/60+" horas"),$("#periodo").val(u));o=new Date(r[0].toDateString()+" "+n[e+"_inicio"]);f=new Date(r[0].toDateString()+" "+n[e+"_fim"]);$(".tag_periodo").click(function(){$(".tag_periodo").removeClass("active");$(this).addClass("active");u=parseInt($(this).attr("periodo"),10);$(".periodo").html("Periodo<br>"+u/60+" horas");$("#periodo").val(u);s()});s();$("#tag_hora .tag_hora").length==0?($("#tag_hora").html('<div class="erro_horario">Não existe horário disponivel para a data selecionada.<\/div>'),$("#demo-calendar-disabled").click(),$(".picker-header").html('<div class="erro_horario_bar">NÃO EXISTE HORÁRIO DISPONÍVEL<br>SELECIONE OUTRA DATA<\/div>')):$(".picker-header").html('<div class="alert_horario_bar">SELECIONE UMA DATA PARA<BR>AGENDAR UM HORÁRIO<\/div>');function s(){var i,r,e;for($(".lstperiodo").show(),t.quantidade=u/60,t.total=(t.preco*t.quantidade).formatMoney(2),$$("#total").html(t.total),$("#tag_hora").html(""),i=o;i<f;i=i.addMinutes(u>60?60:u))r={length:0},controller.carrinho.get()!=null&&(r=$(controller.carrinho.get().produtos).filter(function(n,t){var r=new Date(t.horario1);return r>=i&&r<=i.addMinutes(u)})),r.length==0&&(r=$(n.horario).filter(function(n,t){var r=new Date(t.horario1);return r>=i&&r<=i.addMinutes(t.duracao)})),i.addMinutes(u-1)<f&&r.length==0&&(e=$('<div class="tag_hora" data="'+i.toString()+'" >'+i.toLocaleTimeString().substring(0,5)+" às "+i.addMinutes(u).toLocaleTimeString().substring(0,5)+"<div>"),e.click(function(){$(".tag_hora.active").removeClass("active");$(this).addClass("active");t.horario1=new Date($(this).attr("data"))}),$("#tag_hora").append(e));$("#tag_hora").append('<div style="clear:both"><\/div>');$("#tag_hora .tag_hora").length==0&&$("#tag_hora").html('<div class="erro_horario">Não existe horário disponivel para a data selecionada.<\/div>')}}else $(".picker-header").html('<div class="alert_horario_bar">SELECIONE UMA DATA PARA<BR>AGENDAR UM HORÁRIO<\/div>')},onClose:function(){},toolbarTemplate:'<div class = "toolbar calendar-custom-toolbar"><div class = "toolbar-inner"><div class = "left"><a href = "#" class = "link icon-only picker-calendar-prev-month"><i class = "icon icon-prev"><\/i><\/a><\/div><div class = "center"><span class="current-month-value"><\/span><\/div > <div class = ""><a href = "#" class = "link icon-only picker-calendar-next-month"><i class = "icon icon-next"><\/i><\/a><\/div><\/div><\/div>'})});t.icone==""&&$(".background_produto").addClass("background_produto_hide");$("#unidade").click(function(){myApp.modal({title:"Qual o peso em "+t.unidade+"?",text:'<input class="modal_money" style=padding:10px;color:var(--textbox-font-color);border-radius:2px;background-color:var(--textbox-color);border:0px;text-align:center;" type="tel" mask="money" inputmode="numeric" pattern="[0-9]*" placeholder="0,000" />',buttons:[{text:"Cancelar",onClick:function(){}},{text:"Continuar",onClick:function(){var n=parseFloat($(".modal_money").val().replace(",","."));isNaN(n)||n<=0?myApp.alert("Informe um valor válido!","ATENÇÃO",function(){$("#unidade").click()}):(t.quantidade=parseInt($(".modal_money").val().replace(".",""),10),t.total=(t.preco*n).formatMoney(2),$$("#total").html(t.total),$$("#quantidade").html($(".modal_money").val()))}}]});creait.bind_peso(".modal_money");return});t.quantidade==1&&$("#unidade").click();$$("#btn_adicionar").click(function(){if(t.agenda_id!=null&&t.agenda_id>0&&$(".tag_hora.active").length==0){myApp.alert("Para continuar selecione um horário","Atenção");return}n();controller.login.get()==null||controller.login.get().produto_id==null?creait.redirect("categoria"):creait.redirect("cliente")});creait.redirect("produto","id="+t.categoria_id);$$("#adicionar").click(function(){t.quantidade==t.estoque?myApp.alert("Quantidade no estoque atingido!","Aviso!"):(t.quantidade+=1,t.total=(t.preco*t.quantidade).formatMoney(2),$$("#total").html(t.total),$$("#quantidade").html(t.quantidade))});$$("#remover").click(function(){t.quantidade>1&&(t.quantidade-=1,t.total=(t.preco*t.quantidade).formatMoney(2),t.quantidade<1&&(t.quantidade=1),$$("#total").html(t.total),$$("#quantidade").html(t.quantidade))})})}if(controller.login.get()!=null&&controller.login.get().produto_id!=null&&(controller.carrinho.set(null),controller.endereco.set(null)),t.regiao==null&&controller.login.get()!=null&&controller.login.get().filial_id!=null&&(t.regiao=controller.login.get().filial_id),controller.busca.get()==null&&t.regiao==null||(controller.adicionar.get()==null||controller.adicionar.get().nome==null)&&t.id==null)return"categoria";if(controller.busca.get()==null&&t.regiao!=null){var f=controller.layout.get().filiais,i=null;$(f).each(function(n,r){r.id==t.regiao&&(i=r)});controller.filial.set(i);controller.categoria.init(function(){r()})}else r()},get:function(){return controller.adicionar.memory==null?{}:JSON.parse(controller.adicionar.memory)},set:function(n){controller.adicionar.memory=JSON.stringify(n)},memory:null};controller.comanda={get:function(){return window.localStorage.comanda==null?null:JSON.parse(window.localStorage.comanda)},set:function(n){window.localStorage.comanda=n==null?n:JSON.stringify(n)}};controller.agenda={init:function(n){var i=controller.login.get(),t={};creait.get("pedido?login_id="+i.id,null,function(i){t.compra=i;n(t,function(){})})},get:function(){return window.localStorage.pedidos==null?null:JSON.parse(window.localStorage.pedidos)},set:function(n){window.localStorage.pedidos=JSON.stringify(n)}};controller.avaliacao={init:function(n,t){n({},function(){var n=3;$(".icon-star-full").click(function(){n=parseInt($(this).attr("value"),10);$(".icon-star-full").removeClass("activestar");for(var t=n;t>0;t--)$('.icon-star-full[value="'+t+'"]').addClass("activestar")});$("#avaliar").click(function(){creait.get("produto?estrela="+$($(".activestar").get().reverse()[0]).attr("value")+"&horario_id="+t.id,null,function(){creait.redirect("horario","id="+t.id)})})})},get:function(){return memory},set:function(n){memory=n},memory:null};controller.bemvindo={init:function(n){var t=controller.layout.get();n(t,function(){$("#iniciar").click(function(){localStorage.clear();window.top.location.href="/"})})},get:function(){return window.localStorage.cartao==null?null:JSON.parse(window.localStorage.cartao)},set:function(n){window.localStorage.cartao=n==null?n:JSON.stringify(n)}};controller.cadastro={init:function(n){n({},function(){$$("#btn_sign_up").click(function(){$("#nome_input").toggleInputError($("#nome_input").val()=="","Informe o seu nome");$("#email_input").toggleInputError($("#email_input").val()==""||!creait.isEmail($("#email_input").val()),"Email inválido");localStorage.getItem("pushToken")==null||localStorage.getItem("plataforma_id")==null?($("#pushC").val(""),$("#platC").val("")):($("#pushC").val(localStorage.getItem("pushToken")),$("#platC").val(localStorage.getItem("plataforma_id")));$("#password_input").toggleInputError($("#nome_input").val()==""||$("#password_input").val().length<6,"A senha deve ter no minimo 6 caracteres");$("#password_confirmar_input").toggleInputError($("#password_input").val()!=$("#password_confirmar_input").val(),"A confirmação da senha esta errada");$("#aceite").length>0&&$("#aceite").toggleInputError($("#aceite:checked").length==0,"Para continuar você precisa aceitar os termos de uso");$("formcadastro .has-error").length==0&&creait.post("pessoas",myApp.formToJSON("formcadastro"),function(n){n.erro==null?(controller.login.set(n),controller.carrinho.get()!=null?controller.endereco.get()==null?controller.layout.get().balcao&&controller.layout.get().delivery?creait.redirect("endereco"):controller.busca.get().balcao?creait.redirect("filial"):creait.redirect("endereco"):controller.cartao.get()==null&&controller.pagamento.get()!=null&&controller.pagamento.get().transacao==4?creait.redirect("cartao"):controller.login.get().perfil_id==5?creait.redirect("cliente"):creait.redirect("pagamento"):creait.redirect("categoria")):(myApp.alert(n.erro,"Atenção"),creait.loader(!1))})})})}};controller.carrinho={init:function(n){var t,i;if(controller.carrinho.get()==null){setTimeout(function(){window.location="/"},1e3);return}t=controller.carrinho.get();controller.carrinho.change(t);i=[];$(t.produtos).each(function(n,t){var r=$(i).filter(function(n,i){return i.numero==t.comanda})[0];r==null&&(r={numero:t.comanda,label_numero:t.comanda==""||t.comanda==null?"ITEM(S) ADICIONADO(S)":"REFERÊNCIA "+t.comanda,produtos:[]},t.comanda==""?i.unshift(r):i.push(r));r.produtos.push(t)});t.comandas=i;n(t,function(){function n(n,i){var r=$(t.produtos).filter(function(t,i){return i.id==$(n).closest("[produto_id]").attr("produto_id")&&(i.agrupamentoid==null?"":i.agrupamentoid)==$(n).closest("[agrupamentoid]").attr("agrupamentoid")})[0],u;r.quantidade-=1;r.quantidade<1||i?myApp.confirm("Deseja excluir o item do carrinho?","Atenção!",function(){var u=[],i;$(t.produtos).each(function(n,t){(t.id!=r.id||t.agrupamentoid!=r.agrupamentoid)&&u.push(t)});t.produtos=u;controller.carrinho.set(t);$(n).closest("[produto_id]").remove();i={};controller.carrinho.change(i);i.carrinho_total!=null&&$("#total").html(i.carrinho_total.formatMoney(2));t.carrinho_quantidade==0&&window.localStorage.removeItem("carrinho");t.produtos.length==0?controller.login.get()==null||controller.login.get().produto_id==null?creait.redirect("categoria"):creait.redirect("adicionar","id="+controller.login.get().produto_id+"&regiao="+controller.filial.get().id):$("[quantidade]:contains('0')").closest("[produto_id]").remove();return},function(){r.quantidade=1;r.total=r.preco*r.quantidade;controller.carrinho.set(t);$(n).closest("[produto_id]").find(".quantidade_carrinho").html(r.quantidade);$(n).closest("[produto_id]").find(".total_carrinho").html((r.quantidade*r.preco).formatMoney(2));var i={};controller.carrinho.change(i);$("#total").html(i.carrinho_total.formatMoney(2));return}):(r.total=(r.preco*r.quantidade).formatMoney(2),controller.carrinho.set(t),$(n).closest("[produto_id]").find(".quantidade_carrinho").html(r.quantidade),$(n).closest("[produto_id]").find(".total_carrinho").html(r.total),u={},controller.carrinho.change(u),$("#total").html(u.carrinho_total.formatMoney(2)))}$(".unidade").click(function(n){var n=this,i=$(t.produtos).filter(function(t,i){return i.id==$(n).closest("[produto_id]").attr("produto_id")&&(i.agrupamentoid==null?"":i.agrupamentoid)==$(n).closest("[agrupamentoid]").attr("agrupamentoid")})[0];myApp.modal({title:"Qual o peso em "+i.unidade+"?",text:'<input class="modal_money" style=padding:10px;color:var(--textbox-font-color);border-radius:2px;background-color:var(--textbox-color);border:0px;text-align:center;" type="tel" mask="money" inputmode="numeric" pattern="[0-9]*" placeholder="0,000" />',buttons:[{text:"Cancelar",onClick:function(){}},{text:"Continuar",onClick:function(){var u=parseFloat($(".modal_money").val().replace(",",".")),r;isNaN(u)||u<=0?myApp.alert("Informe um valor válido!","ATENÇÃO",function(){$("#unidade").click()}):(i.quantidade=parseInt($(".modal_money").val().replace(".",""),10),i.total=(i.preco*u).formatMoney(2),controller.carrinho.set(t),$(n).closest("[produto_id]").find(".quantidade_carrinho").html($(".modal_money").val()),$(n).closest("[produto_id]").find(".total_carrinho").html(i.total),r={},controller.carrinho.change(r),r.carrinho_total!=null&&$("#total").html(r.carrinho_total.formatMoney(2)))}}]});creait.bind_peso(".modal_money");return});$(".labelcomprar").click(function(){var t,n;t={};controller.carrinho.change(t);controller.filial.get().minimo!=null&&t.carrinho_total<=controller.filial.get().minimo?myApp.alert("O valor minimo para finalizar a compra é de "+controller.filial.get().minimo.formatMoney(2),"Valor Mínimo"):controller.login.get()!=null&&controller.login.get().perfil_id==3?finalizar_compra():controller.login.get()!=null&&controller.login.get().perfil_id==5&&controller.login.get().external_id!=null?finalizar_compra():controller.layout.get().NotPremium?creait.redirect("premium"):(n=controller.filial.get(),n.seg1==null&&n.seg2==null&&n.seg3==null&&n.seg4==null&&n.ter1==null&&n.ter2==null&&n.ter3==null&&n.ter4==null&&n.qua1==null&&n.qua2==null&&n.qua3==null&&n.qua4==null&&n.qui1==null&&n.qui2==null&&n.qui3==null&&n.qui4==null&&n.sex1==null&&n.sex2==null&&n.sex3==null&&n.sex4==null&&n.sab1==null&&n.sab2==null&&n.sab3==null&&n.sab4==null&&n.dom1==null&&n.dom2==null&&n.dom3==null&&n.dom4==null||(controller.filial.get()[getWeek()+"1"]!=null&&controller.filial.get()[getWeek()+"2"]!=null||controller.filial.get()[getWeek()+"3"]!=null&&controller.filial.get()[getWeek()+"4"]!=null)&&(new Date((new Date).toDateString()+" "+controller.filial.get()[getWeek()+"1"]).getTime()<=(new Date).getTime()&&new Date((new Date).toDateString()+" "+controller.filial.get()[getWeek()+"2"]).getTime()>=(new Date).getTime()||new Date((new Date).toDateString()+" "+controller.filial.get()[getWeek()+"3"]).getTime()<=(new Date).getTime()&&new Date((new Date).toDateString()+" "+controller.filial.get()[getWeek()+"4"]).getTime()>=(new Date).getTime())?controller.endereco.get()!=null?controller.login.get()==null?creait.redirect("login"):creait.redirect("pagamento"):controller.login.get()==null?creait.redirect("endereco","to=login"):creait.redirect("endereco","to=pagamento"):myApp.alert("Estamos fechados no momento","Oops"))});$(".adicionar").click(function(n){var n=this,i=$(t.produtos).filter(function(t,i){return i.id==$(n).closest("[produto_id]").attr("produto_id")&&(i.agrupamentoid==null?"":i.agrupamentoid)==$(n).closest("[agrupamentoid]").attr("agrupamentoid")})[0],r;i.estoque!=null&&i.quantidade>=i.estoque?myApp.alert("Quantidade no estoque atingido!","Aviso!"):(i.quantidade+=1,i.total=(i.preco*i.quantidade).formatMoney(2),controller.carrinho.set(t));$(n).closest("[produto_id]").find(".quantidade_carrinho").html(i.quantidade);$(n).closest("[produto_id]").find(".total_carrinho").html(i.total);r={};controller.carrinho.change(r);r.carrinho_total!=null&&$("#total").html(r.carrinho_total.formatMoney(2))});$(".remover_tudo").click(function(){n(this,!0)});$(".remover").click(function(){n(this)})})},change:function(n){var t=0,i=0,r;controller.carrinho.get()!=null?(r=controller.carrinho.get(),r.produtos.length==0?(controller.carrinho.set(null),$(".panel_carrinho").hide(),$('[data-page="categoria"]').removeClass("carrinho_open")):($('[data-page="categoria"]').addClass("carrinho_open"),$(".panel_carrinho").show(),$(r.produtos).each(function(n,r){r.unidade==null||r.unidade==""?(t=t+r.quantidade*r.preco,i=i+r.quantidade,r.total=(r.quantidade*r.preco).formatMoney(2)):(t=t+creait.convert_int_peso(r.quantidade)*r.preco,i=i+1,r.total=(creait.convert_int_peso(r.quantidade)*r.preco).formatMoney(2))}),controller.carrinho.set(r),n.carrinho_total=t,n.carrinho_quantidade=i)):($(".panel_carrinho").hide(),$('[data-page="categoria"]').removeClass("carrinho_open"))},get:function(){return window.localStorage.carrinho==null?null:JSON.parse(window.localStorage.carrinho)},set:function(n){window.localStorage.carrinho=n==null?n:JSON.stringify(n)},memory:null};controller.cartao={init:function(n,t){var i={};i.login=controller.login.get();i.cartao=controller.cartao.get();creait.get("cartao",{pessoa_id:i.login.id},function(r){r==null?(i.cartao={},i.cartao.numero="",i.cartao.nome="",i.cartao.bandeira="",i.cartao.cvv="",i.cartao.expiracao=""):i.cartao=r;n(i,function(){creait.loader(!1);var n=null;Payment.formatCardExpiry(document.querySelector("#expiracao_input"));Payment.formatCardCVC(document.querySelector("#cvv"));Payment.formatCardNumber(document.querySelector("#cardnumber_input"));$(".back.link").click(function(){t.horario==null?creait.redirect("carrinho"):creait.redirect("horario","id="+t.horario)});$$("#cardnumber_input").keyup(function(){var t=$(this).val();n=Payment.fns.cardType(t);$('[name="bandeira"]').val(n);$("#brand").attr("src","icons/bandeiras/"+n+".svg");$("#brand").css("display","block")});$$("#btn_savar_cartao").click(function(){$("#cardnumber_input").toggleInputError(!Payment.fns.validateCardNumber($("#cardnumber_input").val()),"Cartão esta inválido");$("#nome_input").toggleInputError($("#nome_input").val()=="","Nome obrigatório");$("#expiracao_input").toggleInputError(!($("#expiracao_input").val().split("/").length==2&&Payment.fns.validateCardExpiry($("#expiracao_input").val().split("/")[0],$("#expiracao_input").val().split("/")[1])),"Data inválida");$("#cvv").toggleInputError(!Payment.fns.validateCardCVC($("#cvv").val()),"CCV Inváligo");$("#documento").toggleInputError($("#documento").val()=="","CPF ou CNPJ inválido use apenas números");var n=myApp.formToJSON("formcartao");n.pessoa_id=controller.login.get().id;n.compra_id=t.compra;$("formcartao .has-error").length==0&&creait.post("cartao",n,function(n){n.erro==null?(controller.cartao.set(n),t.atendimento!=null?creait.redirect(controller.busca.get().balcao?"confirmarPedido":"confirmar","id="+t.atendimento):t.horario!=null?creait.redirect("horario","id="+t.horario):creait.redirect(controller.busca.get().balcao?"confirmarPedido":"confirmar")):(creait.loader(!1),myApp.alert(n.erro,"Oops"))})})})})},get:function(){return window.localStorage.cartao==null?null:JSON.parse(window.localStorage.cartao)},set:function(n){window.localStorage.cartao=n==null?n:JSON.stringify(n)}};controller.categoria={navbartop:!0,init:function(n){function r(i){var r;i.navbartop=!0;controller.carrinho.get()!=null&&(i.navbartop=!1);t.seg1==null&&t.seg2==null&&t.seg3==null&&t.seg4==null&&t.ter1==null&&t.ter2==null&&t.ter3==null&&t.ter4==null&&t.qua1==null&&t.qua2==null&&t.qua3==null&&t.qua4==null&&t.qui1==null&&t.qui2==null&&t.qui3==null&&t.qui4==null&&t.sex1==null&&t.sex2==null&&t.sex3==null&&t.sex4==null&&t.sab1==null&&t.sab2==null&&t.sab3==null&&t.sab4==null&&t.dom1==null&&t.dom2==null&&t.dom3==null&&t.dom4==null?(i.aberto="aberto",i.lblaberto="Aberto no momento",i.is_aberto=!0,i.navbartop=!1):t[getWeek()+"1"]==null&&t[getWeek()+"2"]==null&&t[getWeek()+"3"]==null&&t[getWeek()+"4"]==null?(i.aberto="fechado",i.lblaberto="Fechado no momento",i.is_aberto=!1,i.horario_abertura="NÃO ABRIREMOS HOJE"):new Date((new Date).toDateString()+" "+t[getWeek()+"1"]).getTime()<=(new Date).getTime()&&new Date((new Date).toDateString()+" "+t[getWeek()+"2"]).getTime()>=(new Date).getTime()||new Date((new Date).toDateString()+" "+t[getWeek()+"3"]).getTime()<=(new Date).getTime()&&new Date((new Date).toDateString()+" "+t[getWeek()+"4"]).getTime()>=(new Date).getTime()?(i.aberto="aberto",i.lblaberto="Aberto no momento",i.is_aberto=!0,i.navbartop=!1):(i.aberto="fechado",i.lblaberto="Fechado no momento",i.is_aberto=!1,i.horario_abertura=new Date((new Date).toDateString()+" "+t[getWeek()+"1"]).getTime()<=(new Date).getTime()&&new Date((new Date).toDateString()+" "+t[getWeek()+"2"]).getTime()>=(new Date).getTime()?t[getWeek()+"3"].substring(0,4):t[getWeek()+"1"]==null?"Abrimos as "+t[getWeek()+"3"].substring(0,5):"Abrimos as "+t[getWeek()+"1"].substring(0,5));i.url_phone="";i.celular!=null&&i.celular!=""?(i.url_phone=controller.layout.get().whatsapp_message==null||controller.layout.get().whatsapp_message==""?"https://api.whatsapp.com/send?phone="+i.celular.replace("+","").replace("-","")+"&text=Olha%20s%C3%B3%20que%20legal%20o%20aplicativo%20da%20"+encodeURI(i.nome)+"%20http%3A%2F%2F"+encodeURI(window.location.host)+"%2Fapp":"https://api.whatsapp.com/send?phone="+i.celular.replace("+","").replace("-","")+"&text="+encodeURI(controller.layout.get().whatsapp_message),i.celular.indexOf("+55")>-1&&(r=i.celular.replace("+","").replace("-","").slice(4),r=r.length==9?r.slice(0,5)+"-"+r.slice(5,9):r.slice(0,4)+"-"+r.slice(4,8),i.celular="("+i.celular.replace("+","").slice(2,4)+") "+r)):i.telefone!=null&&i.telefone!=""&&(i.telefone.indexOf("+55")>-1&&(r=i.telefone.replace("+","").replace("-","").slice(4),r=r.length==9?r.slice(0,5)+"-"+r.slice(5,9):r.slice(0,4)+"-"+r.slice(4,8),i.celular="("+i.telefone.replace("+","").slice(2,4)+") "+r),i.url_phone="tel:"+i.telefone.replace("+","").replace("-",""));i.place_id=controller.layout.get().place_id;controller.carrinho.change(i);i.categoria_count=i.tipos.length;!0&&(i.categoria_count=i.categoria_count);i.url=window.location.host;i.tempo=controller.filial.get().tempo;i.valor_entrega=biblioteca.get("isAgenda")==!0||controller.endereco.get()==null||controller.endereco.get().valor==null?biblioteca.get("frete"):biblioteca.get("frete")+" "+controller.endereco.get().valor.toUpperCase();i.tipos_length=i.tipos.length;i.mesa=controller.login.get()!=null&&controller.login.get().perfil_id==5;i.caracteristicas=controller.layout.get().caracteristicas;n(i,function(){$(".produtoli[caracteristicas]").show();$(".produtoli[caracteristicas]").each(function(n,t){if(controller.layout.get().length>0){var i=!1;$(controller.layout.get().caracteristicas).each(function(n,r){$(t).attr("caracteristicas")!=""&&$($(t).attr("caracteristicas").split(",")).each(function(n,t){r.id==t&&(i=r.selecionado)})});i||$(t).hide()}});$("[filtrar_caracteristica]").click(function(){var t=JSON.parse($(this).attr("filtrar_caracteristica")),n=controller.layout.get();$(n.caracteristicas).each(function(n,i){i.id==t&&(i.selecionado=!i.selecionado)});controller.layout.set(n);$(".modal-overlay-visible").click();myApp.mainView.refreshPage()});t.seg1==null&&t.seg2==null&&t.seg3==null&&t.seg4==null&&t.ter1==null&&t.ter2==null&&t.ter3==null&&t.ter4==null&&t.qua1==null&&t.qua2==null&&t.qua3==null&&t.qua4==null&&t.qui1==null&&t.qui2==null&&t.qui3==null&&t.qui4==null&&t.sex1==null&&t.sex2==null&&t.sex3==null&&t.sex4==null&&t.sab1==null&&t.sab2==null&&t.sab3==null&&t.sab4==null&&t.dom1==null&&t.dom2==null&&t.dom3==null&&t.dom4==null&&$(".navbartop").remove();i.navbartop||($(".navbartop").hide(),$(".cardapio").click());$(".produtoli:visible").click(function(){creait.redirect($(this).attr("link"),"id="+$(this).attr("produto_id")+"&regiao="+controller.busca.get().id)});controller.login.get()!=null&&(controller.login.get().perfil_id==1||controller.login.get().perfil_id==4)&&($("#whatsapp").click(function(){myApp.prompt("Escolha a mensagem padrão","Whatsapp",function(n){creait.post("whatsapp",{message:n},function(){var t=controller.layout.get();t.whatsapp_message=n;controller.layout.set(t)})},function(){});$("input.modal-text-input").val(controller.layout.get().whatsapp_message)}),$("#whatsapp").removeAttr("href"),$("#whatsapp").removeAttr("target"));creait.loader(!1);i.place_id<6e4&&$(".facebook_page").hide();controller.carrinho.get()==null?($(".panel_carrinho").hide(),$('[data-page="categoria"]').removeClass("carrinho_open")):$('[data-page="categoria"]').addClass("carrinho_open");(controller.login.get()==null||controller.login.get().perfil_id!=1&&controller.login.get().perfil_id!=4)&&($("#novo_tipo").hide(),$(".swipeout").removeClass("swipeout"),$(".swipeout-actions-right").remove());$("[categoria_id]").click(function(){if($(this).closest(".swipeout-opened").length==0){var t=this,n=parseInt($(t).attr("categoria_id"),10);controller.produto.set($(controller.busca.get().tipos).filter(function(t){return t.id==n})[0]);creait.redirect("produto","id="+n)}});var n=controller.endereco.get();n!=null?n.retirada==null?$("#endereco").html(n.street+", "+n.number):$("#endereco").html(n.retirada):$("#endereco").html(biblioteca.get("entrega"));controller.login.get()!=null&&controller.login.get().perfil_id==3?($(".icologin").hide(),$(".link.open-panel.background-creait").removeClass("open-panel"),$(".icon-earth").hide(),$(".tempo_medio").html('<div style="padding-right:10px">'+controller.login.get().nome+"<\/div>"),$(".mesaid").html(controller.login.get().nome),$(".conta").click(function(){creait.redirect("mesa","id="+controller.login.get().cpf)})):controller.login.get()!=null&&controller.login.get().perfil_id==5?($(".mesaid").html(controller.cliente.get().nome),$(".conta").click(function(){creait.redirect("mesa","id="+controller.cliente.get().cpf)})):(i.tempo==null||controller.layout.get().frete_produto==!0)&&$(".tempo_medio").html("");$(".endereco_link").click(function(){controller.login.get()!=null&&controller.login.get().perfil_id==3?creait.redirect("mesa","id="+controller.login.get().id):controller.layout.get().balcao||controller.busca.get().balcao?$(".link.open-panel").click():controller.layout.get().balcao&&controller.layout.get().delivery?window.location="/":controller.busca.get().delivery?creait.redirect("endereco"):creait.redirect("endereco")});$("#linkFb").click(function(){if(inIframe()){var n={linkFb:$("#linkFb").attr("linkFb")};parent.postMessage(JSON.stringify({key:"storage",data:n}),"*")}else window.open($("#linkFb").attr("linkFb"),"_blank")});setTimeout(function(){creait.resize()},2e3)})}var t=controller.filial.get(),i;$(".loader_off").hide();creait.loader(!0);myApp.hidePreloader();t.versao==null&&(t.versao=controller.busca.get().versao,controller.filial.set(t));controller.busca.get()==null||t.id!=controller.busca.get().id||controller.busca.get().versao!=t.versao?$$.ajax({url:"json/"+window.location.host.split(".")[0].replace(":","")+"_"+t.id+"_"+(t.versao==null?"":t.versao)+".json",method:"GET",dataType:"json",success:function(n){controller.busca.set(n);var t=n;controller.carrinho.change(t);n.login=controller.login.get()!=null?controller.login.get():{nome:""};r(t)},error:function(){creait.get("filiais?id="+t.id,null,function(n){controller.busca.set(n);var t=n;controller.carrinho.change(t);n.login=controller.login.get()!=null?controller.login.get():{nome:""};r(t)})}}):(i=controller.busca.get(),i.login=controller.login.get()!=null?controller.login.get():{nome:""},r(i))}};controller.cliente={init:function(n){n({},function(){$("#proximo").click(function(){var n=myApp.formToJSON("formconfir");$('[name="email"]').toggleInputError(n.email.replace(/ /g,"")=="","O email é obrigatório");$('[name="nome"]').toggleInputError(n.nome.replace(/ /g,"")=="","O nome é obrigatório");n.phone.replace(/ /g,"")==""&&n.cpf.replace(/ /g,"")==""&&($('[name="phone"]').toggleInputError(n.phone.replace(/ /g,"")=="","O telefone é obrigatório"),$('[name="phone"]').toggleInputError(n.phone.replace(/ /g,"").length!=10&&n.phone.replace(/ /g,"").length!=11,"Telefone inválido"));$("formconfir .has-error").length==0&&creait.post("confirmarcliente",n,function(n){controller.cliente.set(n);$("#endereco_cliente").is(":visible")?creait.redirect("categoria"):creait.redirect("endereco")})});$("#buscar").click(function(){$("#dados").val()==""||$("#dados").val()==null?myApp.alert("Digite o Email, CPF ou Telefone do Cliente","Atenção!"):creait.get("confirmarcliente?busca="+$("#dados").val(),null,function(n){var t,r,i;n!="0"?($('[name="id"]').val(n.id),n.nome!=null&&n.nome.replace(/ /g,"")!=""&&($('[data-page="confirmarCliente"] #nome').val(n.nome),n.senha!=null&&$('[data-page="confirmarCliente"] #nome').attr("disabled","disabled")),n.email!=null&&n.email.replace(/ /g,"")!=""&&($('[data-page="confirmarCliente"] #email').val(n.email),n.senha!=null&&$('[data-page="confirmarCliente"] #email').attr("disabled","disabled")),n.cpf!=null&&n.cpf.replace(/ /g,"")!=""&&($('[data-page="confirmarCliente"] #cpf').val(n.cpf),n.senha!=null&&$('[data-page="confirmarCliente"] #cpf').attr("disabled","disabled")),n.rg!=null&&n.rg.replace(/ /g,"")!=""&&($('[data-page="confirmarCliente"] #rg').val(n.rg),n.senha!=null&&$('[data-page="confirmarCliente"] #rg').attr("disabled","disabled")),n.telefone!=null&&n.telefone.replace(/ /g,"")!=""&&($('[data-page="confirmarCliente"] #telefone').val(n.telefone),n.senha!=null&&$('[data-page="confirmarCliente"] #telefone').attr("disabled","disabled")),n.cnpj!=null&&n.cnpj.replace(/ /g,"")!=""&&($('[data-page="confirmarCliente"] #cnpj').val(n.cnpj),n.senha!=null&&$('[data-page="confirmarCliente"] #cnpj').attr("disabled","disabled")),n.razao_social!=null&&n.razao_social.replace(/ /g,"")!=""&&($('[data-page="confirmarCliente"] #razao_social').val(n.razao_social),n.senha!=null&&$('[data-page="confirmarCliente"] #razao_social').attr("disabled","disabled")),(n.cnpj!=null||n.cnpj!=""||n.razao_social!=null||n.razao_social!="")&&$('[data-page="confirmarCliente"] #pj').click(),t={adr_address:"",cep:n.cep,city:n.cidade,country:n.pais,delivery:!0,district:n.bairro,formatted_address:"",lat:n.lat,lng:n.lng,number:n.numero,state:n.estado,street:n.endereco,valor:n.valor},t.street!=""?($("#endereco_cliente").show(),$("#endereco_cliente").html(t.street+", "+t.number+(t.bairro==null?"":" - "+t.bairro)),$("#endereco_cliente").unbind("click"),$("#endereco_cliente").click(function(){controller.cliente.set(n);creait.redirect("endereco")})):$("#endereco_cliente").hide(),controller.endereco.set(t),r=controller.layout.get().filiais,i=null,$(r).each(function(t,r){n.filial_id==r.id&&(i=r)}),controller.filial.set(i)):($('[name="id"]').val(""),myApp.alert("Este usuário não possui cadastro","Atenção!"),$('[data-page="confirmarCliente"] #cpf').val(""),$('[data-page="confirmarCliente"] #telefone').val(""),$('[data-page="confirmarCliente"] #nome').val(""),$('[data-page="confirmarCliente"] #email').val(""),$('[data-page="confirmarCliente"] #rg').val(""),$('[data-page="confirmarCliente"] #cnpj').val(""),$('[data-page="confirmarCliente"] #razao_social').val(""),$("#endereco_cliente").hide(),$("#endereco_cliente").html(""),$('[data-page="confirmarCliente"] #dados').val().indexOf("@")!=-1?$('[data-page="confirmarCliente"] #email').val($('[data-page="confirmarCliente"] #dados').val()):$('[data-page="confirmarCliente"] #dados').val().indexOf(")")!=-1&&$('[data-page="confirmarCliente"] #telefone').val($('[data-page="confirmarCliente"] #dados').val()));$(".dadosCli").fadeIn(3e3);creait.loader(!1)})});controller.cliente.get()!=null&&($("#dados").val(controller.cliente.get().email),$("#buscar").click())})},get:function(){return window.localStorage.cliente==null?null:JSON.parse(window.localStorage.cliente)},set:function(n){window.localStorage.cliente=n==null?n:JSON.stringify(n)}};controller.configuracao={init:function(n){n({},function(){$.get("/api/configuracao",null,function(n){function t(n){return $("[name='primary_color']").val(n.primary_color),$("[name='primary_font_color']").val(n.primary_font_color),$("[name='secondary_color']").val(n.secondary_color),$("[name='secondary_font_color']").val(n.secondary_font_color),$("[name='textbox_color']").val(n.textbox_color),$("[name='textbox_font_color']").val(n.textbox_font_color),$("[name='light_color']").val(n.light_color),$("[name='border_color']").val(n.border_color),$("[name='font_light_color']").val(n.border_color),$("[name='bg_color']").val(n.border_color),$("[name='dark_color']").val(n.dark_color),$("[name='font_color']").val(n.font_color),'    <div class="paleta">                                                                                                                                <div style="border-bottom-left-radius: 10px; border-top-left-radius: 10px; background-color:'+n.primary_color+'">                  <\/div>        <div style="background-color:'+n.primary_font_color+'">                                                                                    <\/div>        <div style="background-color:'+n.secondary_color+'">                                                                                       <\/div>        <div style="background-color:'+n.secondary_font_color+'">                                                                                  <\/div>        <div style="background-color:'+n.textbox_color+'">                                                                                         <\/div>        <div style="background-color:'+n.textbox_font_color+'">                                                                                 <\/div>        <div style="background-color:'+n.border_color+'">                                                                                      <\/div>        <div style="background-color:'+n.bg_color+'">                                                                                      <\/div>        <div style="background-color:'+n.font_light_color+'">                                                                                    <\/div>        <div style="background-color:'+n.light_color+'">                                                                                           <\/div>        <div style="background-color:'+n.dark_color+'">                                                                                            <\/div>        <div style="border-bottom-right-radius: 10px; border-top-right-radius: 10px; background-color:'+n.font_color+'">                   <\/div>    <\/div><div style="clear:both"><\/div>                                                                                                                       '}$(n.theme).each(function(n,i){var r=$(t(i));$(r).click(function(){$("[name='primary_color']").val(i.primary_color);$("[name='primary_font_color']").val(i.primary_font_color);$("[name='secondary_color']").val(i.secondary_color);$("[name='secondary_font_color']").val(i.secondary_font_color);$("[name='textbox_color']").val(i.textbox_color);$("[name='textbox_font_color']").val(i.textbox_font_color);$("[name='border_color']").val(i.border_color);$("[name='bg_color']").val(i.border_color);$("[name='font_light_color']").val(i.border_color);$("[name='light_color']").val(i.light_color);$("[name='dark_color']").val(i.dark_color);$("[name='font_color']").val(i.font_color);theme(i);$(".paleta_default").html(r.clone());$$(".close-popup").click();creait.post("configuracao",myApp.formToJSON("formconfiguracao"),function(){})});$(".list_paletas").append(r)});$(".paleta_default").html(t(controller.layout.get()))})})}};controller.confirmar={init:function(n){var t=controller.endereco.get();n(t,function(){t.cpf!=null&&t.cpf!=""&&$(".iscpf").click();$("#btn_complementoendereco").click(function(){$("#confirmar_complemento").toggleInputError(!$("#ckb_complemento").is(":checked")&&$("#confirmar_complemento").val().trim()=="","Informe o complemento");$("#ckb_complemento").is(":checked")&&$("formatte .has-error").removeClass("has-error");$("formatte .has-error").length==0&&(t.cpf=$("#confirmar_cpf input").val(),t.complement=$("#confirmar_complemento").val(),controller.endereco.set(t),creait.redirect("confirmarPedido"))})})},get:function(){return window.localStorage.enderecoprovisorio==null?null:JSON.parse(window.localStorage.enderecoprovisorio)},set:function(n){window.localStorage.enderecoprovisorio=n==null?n:JSON.stringify(n)}};controller.corfirmarEndereco={init:function(n){n({},function(){})},get:function(){return window.localStorage.CEP==null?null:JSON.parse(window.localStorage.CEP)},set:function(n){window.localStorage.CEP=n==null?n:JSON.stringify(n)}};controller.corfirmarNumero={init:function(n){n({},function(){})},get:function(){return window.localStorage.endereco==null?null:JSON.parse(window.localStorage.endereco)},set:function(n){window.localStorage.endereco=n==null?n:JSON.stringify(n)}};controller.confirmarPedido={init:function(n){function h(t){creait.get("promocao",{id:controller.login.get().id},function(){n(t,function(){var r,n,u,i;t.correios&&controller.endereco.get()!=null&&t.fretes!=null||$("#trocar_frete").hide();$("#frete_selecionado").html($(".frete_li").html());$("#frete_selecionado .arrow").removeClass().addClass("icon-pencil2");r=null;$("#label_pagamento").click(function(){controller.pagamento.get().transacao==4?creait.redirect("cartao"):creait.redirect("pagamento")});controller.cliente.get()!=null&&($(".panel_cliente").show(),$("#label_cliente").html('<span class="icon-pencil2"><\/span>'+controller.cliente.get().nome));$("#frete_selecionado").click(function(){$(".frete_li").toggle(400)});$(".frete_li").click(function(){$("#frete_selecionado").html($(this).html());$("#frete_selecionado .arrow").removeClass().addClass("icon-pencil2");r=JSON.parse($(this).find("[data]").attr("data"));$(".frete_li").toggle(400);t.total=t.carrinho.carrinho_total+parseFloat(r.valor_total.replace(",","."));t.valor_frete=parseFloat(r.valor_total.replace(",","."));t.tipo_frete=r.codigo;$("#total_confirmarPedido").html(t.total.formatMoney(2))});$("#trocar_endereco").click(function(){controller.layout.get().balcao&&controller.layout.get().delivery?window.location="/":controller.busca.get().balcao?controller.layout.get().filiais.length!=1&&creait.redirect("filial"):creait.redirect("endereco","to=confirmarPedido")});biblioteca.get("pagamento_no_final",!1)||(n=controller.pagamento.get(),u=controller.login.get(),n.transacao==1&&$("#dinheiro").show(),n.transacao==4?$("#label_pagamento").html('<img style="float:right; height: 20px; margin-top: 8px;" src="icons/bandeiras/'+controller.cartao.get().bandeira+'.svg" /><span class="icon-pencil2"><\/span><span>'+n.nome+'<br><span style="font-weight: bold; font- size: 11.8px;">'+controller.cartao.get().numero+"<\/span><\/span>"):$("#label_pagamento").html('<span class="icon-pencil2"><\/span>'+n.nome),$("#pagamento").attr("pagamento_id",n.pagamento_id));i=controller.endereco.get();i.retirada==null?$("#label_endereco").html('<span class="icon-pencil2"><\/span>'+i.street+", "+i.number+(i.city==null?"":" - "+i.city)):($(".titulo_endereco").html('<i class="icon-location"><\/i>Retirar na loja'),$("#label_endereco").html('<span class="icon-pencil2"><\/span>'+controller.filial.get().nome+" - "+controller.filial.get().endereco));$("#rick").click(function(){finalizar_compra()})})})}var t=controller.busca.get(),e,u,s,f,r,o,i;if(t.carrinho=controller.carrinho.get(),t.formaPagamento=controller.carrinho.change(t.carrinho),t.login=controller.login.get(),i=controller.endereco.get().valor,i=i==null||i.indexOf("R$")==-1?0:parseFloat(controller.endereco.get().valor.replace("R$","").replace(",","."),10),t.total=t.carrinho.carrinho_total+i,t.frete_valor=controller.endereco.get().valor==null?"":controller.endereco.get().valor,e=controller.endereco.get(),u=controller.carrinho.get().produtos.sort(function(n,t){return(n.duracao==null?0:n.duracao)-(t.duracao==null?0:t.duracao)})[0].duracao,u==null&&(u=0),t.tempo=controller.filial.get().tempo,t.tempo==null&&(t.tempo=0),t.tempo=t.tempo+u,t.tempo!=0&&(t.tempo=t.tempo+" à "+(t.tempo+15)+" minutos"),t.correios&&e!=null){for(s=controller.busca.get(),f=[],r=0;r<t.carrinho.produtos.length;r++)if(t.carrinho.produtos[r].quantidade==1)f.push(t.carrinho.produtos[r].id);else for(o=0;o<t.carrinho.produtos[r].quantidade;o++)f.push(t.carrinho.produtos[r].id);i={produtos:f,filial:s.id,CEP_destino:e.cep.replace("-","")};creait.post("calculofrete",i,function(n){n.fretes.length>0&&(t.frete=n.fretes,t.total=t.carrinho.carrinho_total+parseFloat(t.frete[0].valor_total.replace(",",".")),t.valor_frete=parseFloat(t.frete[0].valor_total.replace(",",".")),t.tipo_frete=t.frete[0].codigo);h(t)})}else h(t)}};controller.consulta={init:function(n){var i=controller.login.get(),t={};creait.get("pedido?login_id="+i.id,null,function(i){t.compra=i;n(t,function(){})})},get:function(){return window.localStorage.pedidos==null?null:JSON.parse(window.localStorage.pedidos)},set:function(n){window.localStorage.pedidos=JSON.stringify(n)}};controller.endereco={init:function(n,t){var i=controller.busca.get();$$.ajax({url:"db_json/cidades.json",method:"GET",dataType:"json",success:function(n){var t=controller.filial.get()==null||controller.filial.get().estado==""?"SP":controller.filial.get().estado,i=(controller.filial.get()==null||controller.filial.get().cidade==""?"São Paulo":controller.filial.get().cidade).toLocaleLowerCase().replace(/ /g,"").replace(/\./g,"").normalize("NFD").replace(/[\u0300-\u036f]/g,"");$(n.estados).each(function(n,i){var r=$("<option"+(i.sigla==t?" selected":"")+">"+i.sigla+"<\/option>");r.data("cidades",i.cidades);$("#sel_estado").append(r)});$("#sel_estado").change(function(){$("#sel_cidade").html("");var n=$(this).find("option:selected").data("cidades");$(n).each(function(n,t){$("#sel_cidade").append("<option"+(t.toLocaleLowerCase().replace(/ /g,"").replace(/\./g,"").normalize("NFD").replace(/[\u0300-\u036f]/g,"")==i?" selected":"")+">"+t+"<\/option>")})});$("#sel_estado").change()},error:function(){}});n({},function(){function n(n){function e(n,t){for(var h=n[0],r=n[1],u=!1,i=0,f=t.length-1;i<t.length;f=i++){var o=t[i][0],e=t[i][1],c=t[f][0],s=t[f][1],l=e>r!=s>r&&h<(c-o)*(r-e)/(s-e)+o;l&&(u=!u)}return u}var f,i,r,u;if($("#busca_endereco").val(""),$("#numeroPerfil").val(n.number),$("#estado").val(n.state),$("#cidade").val(n.city),$("#complementoPerfil").val(n.complement),$("#rua").val(n.street),f=controller.layout.get().filiais,i=null,$(f).each(function(t,r){if(i==null)i=r;else{var u=getDistanceFromLatLonInKm(parseFloat(n.lat.replace(",",".")),parseFloat(n.lng.replace(",",".")),r.lat,r.lng),f=getDistanceFromLatLonInKm(parseFloat(n.lat.replace(",",".")),parseFloat(n.lng.replace(",",".")),i.lat,i.lng);f>u&&(i=r)}}),controller.busca.get()==null||controller.busca.get().correios==!1){if($("#endereco_message").hide(),$("#btn_att_edit").show(),r=getDistanceFromLatLonInKm(parseFloat(n.lat.replace(",",".")),parseFloat(n.lng.replace(",",".")),i.lat,i.lng),$("#endereco_distancia").html(r.toFixed(2)+"km"),$("#endereco_tempo").html(i.tempo),(i.tempo==null||i.tempo=="")&&$("#endereco_tempo").parent().remove(),u=!1,i.ceps!=null&&(u=!e([n.lat.replace(",","."),n.lng.replace(",",".")],JSON.parse(i.ceps))),u||i.entrega_distancia_maxima>0&&r>i.entrega_distancia_maxima){$("#li_endereco").hide();$(".cep_escolhido").show();$("#endereco_message").show();$("#btn_att_edit").hide();$("#endereco_frete").html("Grátis");$("#endereco_table").hide();$("#endereco_message").html("Oops, não realizamos entregas para o endereço informado!");return}i.entrega_distancia_maxima==0?($("#endereco_frete").html(i.entraga_valor_km.formatMoney(2)),n.valor=i.entraga_valor_km.formatMoney(2)):($("#endereco_frete").html((i.entraga_valor_km*r).formatMoney(2)),n.valor=(i.entraga_valor_km*r).formatMoney(2));(n.valor==""||r<i.entrega_distancia_gratis)&&($("#endereco_frete").html("Grátis"),n.valor="Grátis")}else $("#endereco_table").hide(),$("#busca_endereco").attr("placeholder","Informe seu CEP"),$("#busca_endereco").attr("type","number");$(".has-error").removeClass("has-error");$("#btn_att_edit").unbind("click");$("#btn_att_edit").click(function(){$("[digitar_cep]").is(":visible")&&($("#sel_rua").toggleInputError($("#sel_rua").val().replace(/ /g,"")=="","Informe o endereço"),n.street=$("#sel_rua").val());$("#numeroPerfil").toggleInputError($("#numeroPerfil").val().replace(/ /g,"")=="","Informe o número");$("formatte .has-error").length==0&&(n.number=$("#numeroPerfil").val(),n.complement=$("#complementoPerfil").val(),n.delivery=!0,controller.endereco.set(n),controller.filial.set(i),t.to==null?controller.endereco.get()==null?window.location="/":controller.login.get()==null?creait.redirect("categoria"):controller.pagamento.get()!=null?controller.busca.get()!=null&&controller.busca.get().id==i.id?controller.pagamento.get().transacao==4?controller.cartao.get()==null?creait.redirect("cartao"):creait.redirect("pagamento"):creait.redirect("pagamento"):creait.redirect("categoria"):creait.redirect("categoria"):creait.redirect(t.to))});($("#li_endereco").is(":visible")||$(".cep_escolhido").is(":visible"))&&$("#btn_att_edit").click()}biblioteca.get("endereco_table",!0)==!1&&$("#endereco_table").remove();controller.layout.get().frete_produto==!0&&$("#endereco_table").hide();controller.busca.get()==null&&$("#voltar_endereco_edit").hide();controller.login.get()!=null&&controller.login.get().perfil_id==7&&($("#voltar_endereco_edit").show(),controller.cliente.get()!=null&&$(".endereco_mensagem").html("<div>CLIENTE: "+controller.cliente.get().nome+"<\/div>"));controller.layout.get().place_id<6e4&&$(".facebook_page").hide();window.gmap_async==null&&(window.gmap_async=$.getScript("https://maps.googleapis.com/maps/api/js?key=AIzaSyCIoBAvqfno0lFGhuzuuwqX0KmXRdr-10o&libraries=places&callback=maps_callback"));window.gmap_async.done(function(){function t(t,u){r.getPlacePredictions({input:t,types:[u],bounds:i,componentRestrictions:{country:"br"}},function(t,i){if(t==null||t.length<1){myApp.alert("O endereço inforamado não foi encontrado","Oops");return}i===google.maps.places.PlacesServiceStatus.OK&&($("#list_enderecos").html(""),$(t).each(function(i,r){var u=new google.maps.places.PlacesService($("<div><\/div>")[0]);u.getDetails({placeId:r.place_id},function(i){var f=i.geometry.location.lat(),e=i.geometry.location.lng(),r={cep:"",street:"",city:"",district:"",state:"",country:"",lat:f.toString().replace(".",","),lng:e.toString().replace(".",","),formatted_address:"",number:"",complement:"",delivery:!0},u;$(i.address_components).each(function(n,t){$(t.types).each(function(n,i){switch(i){case"street_number":r.number=t.long_name;$("#numeroPerfil").val(r.number);break;case"postal_code":r.cep=t.long_name;break;case"route":r.street=t.long_name;break;case"administrative_area_level_1":r.state=t.short_name;break;case"sublocality_level_1":r.district=t.short_name;break;case"administrative_area_level_2":r.city=t.long_name;break;case"country":r.country=t.long_name}})});r.adr_address=i.adr_address;t.length==1?($("#endereco_table").show(),n(r),r.street!=""?$(".digitar_cep").is(":visible")&&($("[fixo_cep]").show(),$("[digitar_cep]").hide(),$(".cep_escolhido").show(400),$(".digitar_cep").hide(400)):($("[fixo_cep]").hide(),$("[digitar_cep]").show(),$(".digitar_cep").hide(400),$(".cep_escolhido").show(400))):(u=$('<li><i class="f7-icons fonte_cinza">angle-right<\/i>'+i.adr_address+"<\/li>"),$("#list_enderecos").append(u),u.click(function(){r.number=$("#numeroPerfil").val();n(r)}))})}),t.length>1&&($(".cep_escolhido").toggle(400),$("#li_endereco").toggle(400)))})}var r=new google.maps.places.AutocompleteService,i=null;controller.busca.get()!=null&&(i=new google.maps.LatLngBounds(new google.maps.LatLng(controller.busca.get().lat,controller.busca.get().lng)));$("#btn_buscar").click(function(){$("#busca_endereco").toggleInputError($("#busca_endereco").val().length!=8,"CEP incorreto");$("#busca_endereco").hasClass("has-error")||(t($("#busca_endereco").val(),"geocode"),$(".has-error").removeClass("has-error"),$("#btn_att_edit").unbind("click"),$("#btn_att_edit").click(function(){$("#sel_rua").toggleInputError($("#sel_rua").val().replace(/ /g,"")=="","Informe o endereço");$("#numeroPerfil").toggleInputError($("#numeroPerfil").val().replace(/ /g,"")=="","Informe o número");$("formatte .has-error").length==0&&t($("#sel_rua").val()+", "+$("#numeroPerfil").val()+" - "+$("#sel_cidade option:selected").html()+", "+$("#sel_estado option:selected").html(),"address")}))});$("#digitarendereco").click(function(){$("#endereco_table").hide();$("#endereco_message").hide();$("#btn_att_edit").show();$(".digitar_cep").toggle(400);$(".cep_escolhido").toggle(400);$("[fixo_cep]").hide();$("[digitar_cep]").show();$(".has-error").removeClass("has-error");$("#btn_att_edit").unbind("click");$("#btn_att_edit").click(function(){$("#sel_rua").toggleInputError($("#sel_rua").val().replace(/ /g,"")=="","Informe o endereço");$("#numeroPerfil").toggleInputError($("#numeroPerfil").val().replace(/ /g,"")=="","Informe o número");$("formatte .has-error").length==0&&t($("#sel_rua").val()+", "+$("#numeroPerfil").val()+" - "+$("#sel_cidade option:selected").html()+", "+$("#sel_estado option:selected").html(),"address")})})});var i=controller.login.get();$("#activePerfil").val("true");$("#voltar_endereco_edit").click(function(){controller.login.get()!=null&&controller.login.get().perfil_id==7?creait.redirect("cliente"):t.to==null?controller.layout.get().delivery&&controller.layout.get().balcao?window.location="/":controller.pagamento.get()!=null?creait.redirect("pagamento"):creait.redirect("categoria"):creait.redirect(t.to)});setTimeout(function(){$("#cepPerfil").focus()},500)})},get:function(){return window.localStorage.enderecoprovisorio==null?null:JSON.parse(window.localStorage.enderecoprovisorio)},set:function(n){window.localStorage.enderecoprovisorio=n==null?n:JSON.stringify(n)}};controller.entrar={init:function(n){n({},function(){$("#fileqrcode").change(function(){var n=this,t;n.files&&n.files[0]&&(t=new FileReader,t.onload=function(n){qrcode.decode(n.target.result);qrcode.callback=function(n){$('[name="email"]').val(n);$("#btn_entrar_mesa").click()}},t.readAsDataURL(n.files[0]))});$("#btn_entrar_mesa").click(function(){creait.loader(!0,"BUSCANDO CARDÁPIO");creait.get("pessoas",myApp.formToJSON("form_entrar_mesa"),function(n){if(myApp.closePanel(),creait.loader(!1),n==null||n.length==0||n.error!=null){myApp.alert("Esta mesa não existe","Oops ...");return}myApp.closePanel();controller.login.set(n[0]);creait.redirect("categoria")})});$("#btn_lembrar").click(function(){$("#txt_lembrar").toggleInputError($("#txt_lembrar").val()=="","Informe um email");$("#txt_lembrar.has-error").length==0&&creait.get("lembrar?email="+$("#txt_lembrar").val(),null,function(n){myApp.alert(n.message)})})})}};controller.filial={init:function(n){n(controller.layout.get(),function(){$(".redirecionar_categoria").click(function(){controller.filial.set(JSON.parse($(this).attr("data")));controller.endereco.set({retirada:"RETIRAR NA LOJA"});controller.login.get()!=null?controller.login.get().perfil_id==5&&controller.carrinho.get()!=null?creait.redirect("confirmarPedido"):creait.redirect("categoria"):creait.redirect("categoria")})})},get:function(){return window.localStorage.filial_id==null?null:JSON.parse(window.localStorage.filial_id)},set:function(n){window.localStorage.filial_id=n==null?n:JSON.stringify(n)}};controller.finalizar={init:function(n){var t=controller.busca.get();t.carrinho=controller.carrinho.get();n(t,function(){})}};controller.horario={init:function(n,t){var r=controller.login.get(),i=t.id;creait.get("acompanhamento?horario_id="+i,null,function(r){r.tempolimite=new Date(r.horario1).addMinutes(r.duracao*60)<new Date;controller.avaliacao.set(r);n(r,function(){var n,f,u;if(r.compra.valor_frete!=null&&(r.compra.total=r.compra.total+r.compra.valor_frete),$(".total_acompanhamento").html(r.compra.total.formatMoney(2)),n=r.compra.comprador_id,controller.login.get().perfil_id==2&&(n=r.pedido[0].produto.administrador_id),$(".cancelar_horario").unbind("click"),$(".cancelar_horario").click(function(){creait.get("compras?horario_id="+i+"&status=4&para="+n,{},function(){myApp.mainView.refreshPage()})}),$(".avancar_horario").unbind("click"),$(".avancar_horario").click(function(){creait.get("compras?horario_id="+i+"&status=1&para="+n,{},function(){myApp.mainView.refreshPage()})}),$(".iniciar_atendimento").unbind("click"),$(".iniciar_atendimento").click(function(){creait.get("compras?horario_id="+i+"&status=2&para="+n,{},function(){myApp.mainView.refreshPage()})}),$(".finalizar_atendimento").unbind("click"),$(".finalizar_atendimento").click(function(){creait.get("compras?horario_id="+i+"&status=3&para="+n,{},function(){myApp.mainView.refreshPage()})}),r.avaliacao==null)$(".avaliar_horario").unbind("click"),$(".avaliar_horario").click(function(){creait.redirect("avaliacao","id="+t.id)}),$(".content_estrela").unbind("click"),$(".content_estrela").click(function(){creait.redirect("avaliacao","id="+t.id)});else for($(".content_estrela").unbind("click"),$(".avaliar_horario div").html("Minha Avaliação &nbsp;&nbsp;"),f=0;f<r.avaliacao;f++)$(".avaliar_horario div").append('<i class="icon-star-full"><\/i>');r.numero==null?($("#endereco").html("PRODUTO RETIRADO NA LOJA"),$("#pedido_entregue").closest(".col-33").hide(),u=$(".bg-acompanhamento .col-33"),u.removeClass("col-33"),u.addClass("col-50"),$(u[1]).find(".label-acompanhamento").text("FINALIZADO"),$(".iconecommerce-truck-4").removeClass(".iconecommerce-truck-4").addClass("iconecommerce-box"),$(u[1]).find(".acompanhamento-line").hide()):$("#endereco").html('<i class="flaticon-location-pin"><\/i>  '+r.endereco+(r.numero==null?"":", "+r.numero)+(r.complemento==null?"":" - "+r.complemento)+""+(r.compra.valor_frete==null||r.compra.valor_frete==0?"":" - "+biblioteca.get("frete")+": "+r.compra.valor_frete.formatMoney(2)));r.agenda_id!=null&&($(".transportando").html("ATENDIMENTO"),$(".entregue").html("FINALIZADO"),$(".iconecommerce-truck-4").removeClass("iconecommerce-truck-4").removeClass("glyph-icon").addClass("icon-user-check"),$(".iconecommerce-box").removeClass("iconecommerce-box").removeClass("glyph-icon").addClass("icon-aid-kit"))});$(".titulo_horario").html(r.hora_date+'<br><span style="font-size:12px;    letter-spacing: 2px;">DURAÇÃO '+r.duracao+"Hrs<\/span>")})}};controller.item={init:function(n){var i=controller.login.get(),t={semanas:[{txt:"seg",label:"Segunda Feira",inicio:"",termino:""},{txt:"ter",label:"Terça Feira",inicio:"",termino:""},{txt:"qua",label:"Quarta Feira",inicio:"",termino:""},{txt:"qui",label:"Quinta Feira",inicio:"",termino:""},{txt:"sex",label:"Sexta Feira",inicio:"",termino:""},{txt:"sab",label:"Sabado",inicio:"",termino:""},{txt:"dom",label:"Domingo",inicio:"",termino:""},]};creait.get("agenda?id="+controller.login.get().id,{},function(i){$(t.semanas).each(function(n,t){t.inicio=i[t.txt+"_inicio"];t.termino=i[t.txt+"_fim"]});i!=null&&(t.id=i.id);n(t,function(){$("#btn_calendario").click(function(){var n=myApp.formToJSON("formcalendario");$(t.semanas).each(function(t,i){$('[name="'+i.txt+'_inicio"]').toggleInputError(n[i.txt+"_inicio"]>n[i.txt+"_fim"],"O horário de inicio deve ser maior que o termino");$('[name="'+i.txt+'_fim"]').toggleInputError(n[i.txt+"_inicio"]!=""&&n[i.txt+"_fim"]=="","Informe a data de termino");$('[name="'+i.txt+'_inicio"]').toggleInputError(n[i.txt+"_inicio"]==""&&n[i.txt+"_fim"]!="","Informe a data de inicio")});$("formcadastro .has-error").length==0&&creait.post("agenda",n,function(){})})})})},get:function(){return window.localStorage.pedidos==null?null:JSON.parse(window.localStorage.pedidos)},set:function(n){window.localStorage.pedidos=JSON.stringify(n)}};controller.lembrar={init:function(n){n({},function(){$("#btn_lembrar").click(function(){$("#txt_lembrar").toggleInputError($("#txt_lembrar").val()=="","Informe um email");$("#txt_lembrar.has-error").length==0&&creait.get("lembrar?email="+$("#txt_lembrar").val(),null,function(n){myApp.alert(n.message)})})})}};controller.login={init:function(n){n({},function(){$$("#btn_login").click(function(){$("#email").toggleInputError($("#email").val()=="","Informe um email");$("#senha").toggleInputError($("#senha").val()=="","Informe uma senha");localStorage.getItem("pushToken")==null||localStorage.getItem("plataforma_id")==null?($("#push_id").val(""),$("#plataforma").val("")):($("#push_id").val(localStorage.getItem("pushToken")),$("#plataforma").val(localStorage.getItem("plataforma_id")));$("formlogin .has-error").length==0&&creait.get("pessoas",myApp.formToJSON("formlogin"),function(n){if(n==null||n.length==0||n.error!=null){creait.loader(!1);myApp.alert("Usuário ou senha inválido!","Oops ...");return}myApp.closePanel();controller.cartao.set(null);controller.login.set(n[0]);controller.carrinho.get()!=null?controller.endereco.get()==null?controller.layout.get().balcao&&controller.layout.get().delivery?creait.redirect("endereco"):controller.busca.get().balcao?creait.redirect("filial"):creait.redirect("endereco"):controller.cartao.get()==null&&controller.pagamento.get()!=null&&controller.pagamento.get().transacao==4?creait.redirect("cartao"):controller.login.get().perfil_id==5?creait.redirect("pagamento"):controller.login.get().perfil_id==6?creait.redirect("pagamento"):creait.redirect("pagamento"):creait.redirect("categoria")})});$$("#voltar_login").click(function(){localStorage.getItem("carrinho")!=null?creait.redirect("pagamento"):creait.redirect("index")})})},get:function(){return window.localStorage.login==null?null:JSON.parse(window.localStorage.login)},set:function(n){window.localStorage.login=JSON.stringify(n)}};controller.mesa={init:function(n,t){var r=controller.login.get(),i=t.id;if(controller.login.get()==null)return"entrar";if(i==null)return"categoria";creait.get("mesa?mesa_id="+i+"&filial_id="+controller.filial.get().id,null,function(t){t.tamanho="180px";controller.login.get()!=null&&controller.login.get().perfil_id==5&&(t.tamanho="230px");n(t,function(){function n(n,t){myApp.modal({title:"DESBLOQUEAR",text:'<input class="modal_money" style=padding:10px;color:var(--textbox-font-color);border-radius:2px;background-color:var(--textbox-color);border:0px;text-align:center;" type="number"  inputmode="numeric" pattern="[0-9]*" placeholder="Senha" />',buttons:[{text:"Cancelar",onClick:function(){}},{text:"Continuar",onClick:function(){creait.get("garcom",{filial_id:controller.filial.get().id,senha:$(".modal_money").val(),tipo:n},function(n){n==null?myApp.alert("Senha inválida","Atenção"):t();creait.loader(!1)})}}]})}var r=t.mesa.total,u;if(r>0?$("#valor_parcial").text((r/t.mesa.lugares).formatMoney(2)):$("#valor_parcial").text("R$0,00"),$(".unidade").click(function(){var n=$(this),t=JSON.parse(n.attr("pedido_id"));myApp.modal({title:"Qual o peso do produto?",text:'<input class="modal_money" style=padding:10px;color:var(--textbox-font-color);border-radius:2px;background-color:var(--textbox-color);border:0px;text-align:center;" type="tel" mask="money" inputmode="numeric" pattern="[0-9]*" placeholder="0,000" />',buttons:[{text:"Cancelar",onClick:function(){}},{text:"Continuar",onClick:function(){var n=parseFloat($(".modal_money").val().replace(",","."));isNaN(n)||n<=0?myApp.alert("Informe um valor válido!","ATENÇÃO",function(){$("#unidade").click()}):creait.get("altec_pedido",{filial_id:controller.filial.get().id,id:t,quantidade:n},function(){myApp.mainView.refreshPage()})}}]});creait.bind_peso(".modal_money");return}),$("#servico").click(function(){n("taxa",function(){var n=$(this);myApp.modal({title:"Qual o valor do serviço?",text:'<input class="modal_money" style=padding:10px;color:var(--textbox-font-color);border-radius:2px;background-color:var(--textbox-color);border:0px;text-align:center;" type="number"  inputmode="numeric" pattern="[0-9]*" placeholder="Porcentagem" />',buttons:[{text:"Cancelar",onClick:function(){}},{text:"Continuar",onClick:function(){var n=parseInt($(".modal_money").val().replace(",","."));isNaN(n)||n<=0?myApp.alert("Informe um valor válido!","ATENÇÃO",function(){$("#unidade").click()}):creait.get("mesa",{servico:n,mesa_id:i},function(){myApp.mainView.refreshPage()})}}]})})}),$("#excluir_item").click(function(){n("excluir",function(){var n="";$("li.hover").each(function(t,i){n+="|"+$(i).attr("produto_id")});creait.get("altec_pedido",{filial_id:controller.filial.get().id,ids:n},function(){myApp.mainView.refreshPage()})})}),$("#desconto_item").click(function(){var t=$(this);n("desconto",function(){var n="";$("li.hover").each(function(t,i){n+="|"+$(i).attr("produto_id")});myApp.modal({title:"",text:"Qual o tipo do desconto?",buttons:[{text:"Valor",onClick:function(){myApp.modal({title:"Qual o valor do desconto?",text:'<input class="modal_money" style=padding:10px;color:var(--textbox-font-color);border-radius:2px;background-color:var(--textbox-color);border:0px;text-align:center;" type="tel" mask="money" inputmode="numeric" pattern="[0-9]*" placeholder="R$0,00" />',buttons:[{text:"Cancelar",onClick:function(){}},{text:"Continuar",onClick:function(){var t=parseFloat($(".modal_money").val().replace(",","."));isNaN(t)&&(t=0);t<0?myApp.alert("Informe um valor válido!","ATENÇÃO",function(){$("#unidade").click()}):creait.get("altec_pedido",{filial_id:controller.filial.get().id,desconto:t,ids:n,porcentagem:!1},function(){myApp.mainView.refreshPage()})}}]});creait.bind_money(".modal_money")}},{text:"Porcentagem",onClick:function(){myApp.modal({title:"Qual a porcentagem do desconto?",text:'<input class="modal_money" style=padding:10px;color:var(--textbox-font-color);border-radius:2px;background-color:var(--textbox-color);border:0px;text-align:center;" type="number"  inputmode="numeric" pattern="[0-9]*" placeholder="Porcentagem" />',buttons:[{text:"Cancelar",onClick:function(){}},{text:"Continuar",onClick:function(){var t=parseFloat($(".modal_money").val().replace(",","."));isNaN(t)&&(t=0);t<0?myApp.alert("Informe um valor válido!","ATENÇÃO",function(){$("#unidade").click()}):creait.get("altec_pedido",{filial_id:controller.filial.get().id,desconto:t,ids:n,porcentagem:!0},function(){myApp.mainView.refreshPage()})}}]})}}]})})}),$("#transferir").click(function(){var t=$(this);n("transferencia",function(){myApp.modal({title:"Informe o local de transferencia",text:'<input class="modal_money" style=padding:10px;color:var(--textbox-font-color);border-radius:2px;background-color:var(--textbox-color);border:0px;text-align:center;" type="number"  inputmode="numeric" pattern="[0-9]*" placeholder="MESA" />',buttons:[{text:"Cancelar",onClick:function(){}},{text:"Continuar",onClick:function(){var n=parseFloat($(".modal_money").val().replace(",",".")),t;isNaN(n)||n<=0?myApp.alert("Informe um valor válido!","ATENÇÃO",function(){$("#unidade").click()}):(t="",$("li.hover").each(function(n,i){t+="|"+$(i).attr("produto_id")}),creait.get("mesa",{ids:t,mesa_destino:n,mesa_id:i},function(){myApp.mainView.refreshPage()}))}}]})})}),$("#desconto").click(function(){var r=$(this);n("desconto",function(){myApp.modal({title:"",text:"Qual o tipo do desconto?",buttons:[{text:"Valor",onClick:function(){myApp.modal({title:"Qual o valor do desconto?",text:'<input class="modal_money" style=padding:10px;color:var(--textbox-font-color);border-radius:2px;background-color:var(--textbox-color);border:0px;text-align:center;" type="tel" mask="money" inputmode="numeric" pattern="[0-9]*" placeholder="R$0,00" />',buttons:[{text:"Cancelar",onClick:function(){}},{text:"Continuar",onClick:function(){var n=parseFloat($(".modal_money").val().replace(",","."));isNaN(n)&&(n=0);n<0?myApp.alert("Informe um valor válido!","ATENÇÃO",function(){$("#unidade").click()}):creait.get("mesa",{desconto:n,mesa_id:i},function(){r.find("span").text(n==0?"R$0,00":n.formatMoney());t.mesa.total=t.mesa.subtotal+t.mesa.subtotal*t.mesa.servico/100-n;$("#total").find("span").text(t.mesa.total==0?"R$0,00":t.mesa.total.formatMoney());creait.loader(!1)})}}]});creait.bind_money(".modal_money")}},{text:"Porcentagem",onClick:function(){myApp.modal({title:"Qual a porcentagem do desconto?",text:'<input class="modal_money" style=padding:10px;color:var(--textbox-font-color);border-radius:2px;background-color:var(--textbox-color);border:0px;text-align:center;" type="number"  inputmode="numeric" pattern="[0-9]*" placeholder="Porcentagem" />',buttons:[{text:"Cancelar",onClick:function(){}},{text:"Continuar",onClick:function(){var n=parseFloat($(".modal_money").val().replace(",","."));isNaN(n)&&(n=0);n<0?myApp.alert("Informe um valor válido!","ATENÇÃO",function(){$("#unidade").click()}):creait.get("mesa",{desconto:n,mesa_id:i},function(){r.find("span").text(n.formatMoney());t.mesa.total=t.mesa.subtotal+t.mesa.subtotal*t.mesa.servico/100-n;$("#total").find("span").text(t.mesa.total==0?"R$0,00":t.mesa.total.formatMoney());creait.loader(!1)})}}]})}}]})})}),$(".f7-icons.remover").click(function(){var t=$(this),i=parseInt(t.parent().find("span").text(),10),r=JSON.parse(t.attr("pedido_id"));n("excluir",function(){function n(){creait.get("altec_pedido",{filial_id:controller.filial.get().id,id:r,somar:!1},function(){myApp.mainView.refreshPage()})}i==1?myApp.confirm("Deseja excluir este item?","",function(){n(function(){t.closest(".produto_mesa").remove()})}):n(function(){})})}),$(".f7-icons.adicionar").click(function(){var t=$(this),r=parseInt(t.parent().find("span").text(),10),i=JSON.parse(t.attr("pedido_id"));n("excluir",function(){function n(){creait.get("altec_pedido",{filial_id:controller.filial.get().id,id:i,somar:!0},function(){myApp.mainView.refreshPage()})}n(function(){})})}),$("[complemento]").click(function(){if(controller.login.get().perfil_id==3)return!1;var n=$(this),t=JSON.parse(n.attr("complemento"));myApp.confirm("Deseja excluir este item?",t.nome,function(){creait.get("altec_complemento",{filial_id:controller.filial.get().id,id:t.id},function(){n.remove();creait.loader(!1)})})}),$("#qtd_pessoas").click(function(){myApp.modal({title:"Qual o numero de pessoas?",text:'<input class="modal_money" style=padding:10px;color:var(--textbox-font-color);border-radius:2px;background-color:var(--textbox-color);border:0px;text-align:center;" type="number"  inputmode="numeric" pattern="[0-9]*" placeholder="Quantidade" />',buttons:[{text:"Cancelar",onClick:function(){}},{text:"Continuar",onClick:function(){var n=parseFloat($(".modal_money").val().replace(",","."));isNaN(n)||n<=0?myApp.alert("Informe um valor válido!","ATENÇÃO",function(){$("#unidade").click()}):creait.get("mesa",{lugares:n,mesa_id:i},function(){creait.loader(!1);$("#qtd_pessoas").find("div").text(n+" PESSOA(S)");r>0?$("#valor_parcial").text((r/parseInt(n)).formatMoney(2)):$("#valor_parcial").text("R$0,00")})}}]})}),t.mesa.produtos.length==0)$("#fechar_conta").html("MESA ABERTA"),$("#pedirmais").css("width","100%"),$("#fechar_conta").hide(),$("#fechar_conta_notificar").hide(),$("#pedido").html(t.mesa.nome+' <div style="font-size:10px; ">ABERTA<\/div>');else{for($("#pedido").html(t.mesa.nome+' <div style="font-size:10px; ">TEMPO '+calcular_tempo(t.mesa.abertura)+"<\/div>"),u=0;u<99999;u++)window.clearInterval(u);setInterval(function(){$("#pedido").html(t.mesa.nome+' <div style="font-size:10px;">TEMPO '+calcular_tempo(t.mesa.abertura)+"<\/div>")},1e3);$("#fechar_conta").click(function(){n("reabrir",function(){var n={comprador_id:i,vendedor_id:controller.login.get().id,filial_id:controller.filial.get().id,status_mesa:t.mesa.status};creait.post("fechar",n,function(){creait.redirect("mesas")})})});$("#abrir_conta").click(function(){var n={comprador_id:i,vendedor_id:controller.login.get().id,filial_id:controller.filial.get().id,status_mesa:t.mesa.status};creait.post("fechar",n,function(){creait.redirect("mesas")})})}controller.login.get()!=null&&controller.login.get().perfil_id==3&&$(".mesa_voltar").hide();$("#pedirmais").click(function(){controller.login.get().perfil_id==5?controller.cliente.set({id:t.mesa.id,nome:t.mesa.nome,cpf:i}):controller.login.get().perfil_id==3&&controller.carrinho.set(null);creait.redirect("categoria")});t.mesa.status=="L"&&$("#qtd_pessoas").click()})})}};controller.mesas={init:function(n){var i=controller.login.get(),t={};creait.get("pedido?vendedor_id="+i.id+"&filial_id="+controller.filial.get().id,null,function(i){t.mesas=i;i.erro!=null&&(t.mesas=[]);n(t,function(){$(".legenda").click(function(){var n=$(this);n.toggleClass("selecionada");$("li[status]").hide();$(".legenda.selecionada").each(function(){$('li[status="'+$(this).attr("status")+'"]').show()})});$(".tempo_mesas").each(function(n,t){function i(){var n=calcular_tempo($(t).attr("data"));n=n==null?"LIBERADA":"TEMPO "+n;$(t).html(n)}i();setInterval(function(){i()},1e3)})})})},get:function(){return window.localStorage.pedidos==null?null:JSON.parse(window.localStorage.pedidos)},set:function(n){window.localStorage.pedidos=JSON.stringify(n)}};controller.montagem={init:function(n,t){adicionar_produto_memoria(t);var i=controller.adicionar.get();i==null?n({},function(){setTimeout(function(){creait.redirect("categoria")},1e3)}):n(i,function(){$('[name="rdb_complementos"]').change(function(){var n=parseInt(this.value,10);$(this).is(":checked")?($(this.parentNode.parentNode).addClass("active"),controller.montagem.adicionar(n,!0)):($(this.parentNode.parentNode).removeClass("active"),controller.montagem.adicionar(n,!1))});creait.resize();setTimeout(function(){creait.resize()},1e3)});$('[step="1"]').length>0&&($("#lbl_proximo").html($('[step="1"]').attr("montagem_nome")),$("#lbl_proximo").html("Próximo"));$("#complemento_nome").html($("[montagem_nome]:visible").attr("montagem_nome"));i.montagem[0].max>1&&$("#complemento_nome").append('<div class="selecione">Seleciona até '+i.montagem[0].max+" itens<\/div>");$("#voltar").unbind("click");$("#voltar").click(function(){var n=parseInt($(".tab.active").attr("step"),10),t=controller.adicionar.get();n>0?($(t.montagem[n-1].complemento).each(function(n,t){t.selecionado=!1}),controller.adicionar.set(t),$("#tab"+(n-1)).find('[name="rdb_complementos"]').removeAttr("checked"),myApp.showTab("#tab"+(n-1)),$("#complemento_nome").html($('[step="'+(n-1)+'"]').attr("montagem_nome")),$("#lbl_proximo").html($('[step="'+n+'"]').attr("montagem_nome")),$("#lbl_proximo").html("Próximo"),$("#tab"+(n-1)+" .produtoli.active").removeClass("active"),t.montagem[n-1].max>1&&$("#complemento_nome").append('<div class="selecione">Seleciona até '+t.montagem[n-1].max+" itens<\/div>")):creait.redirect("produto")});i.montagem[0].max==1&&$("#tab0 .toolbar").hide();myApp.showTab("#tab0");$("#avancar").unbind("click");$("#avancar").click(function(){var t=controller.adicionar.get(),n=parseInt($(".tab.active").attr("step"),10);t.montagem[n].min>t.montagem[n].complemento.filter(function(n){return n.selecionado==!0}).length?myApp.alert("Selecione no minimo "+t.montagem[n].min+" item.","ATENÇÃO"):$(".tab")[n+1]!=null?($("#complemento_nome").html($('[step="'+(n+1)+'"]').attr("montagem_nome")),$('[step="'+(n+2)+'"]').length!=0?($("#lbl_proximo").html($('[step="'+(n+2)+'"]').attr("montagem_nome")),$("#lbl_proximo").html("Próximo")):$("#lbl_proximo").html("Finalizar"),myApp.showTab("#tab"+(n+1)),t.montagem[n+1].max>1&&$("#complemento_nome").append('<div class="selecione">Seleciona até '+t.montagem[n+1].max+" itens<\/div>")):controller.montagem.finalizar(t);creait.resize()});creait.resize()},adicionar:function(n,t){var r=controller.adicionar.get(),i=parseInt($(".tab.active").attr("step"),10),u=r.montagem[i].complemento.filter(function(t){return t.product_id==n})[0];u.selecionado=t;r.montagem[i].max==r.montagem[i].complemento.filter(function(n){return n.selecionado==!0}).length?($("#complemento_nome").html($('[step="'+(i+1)+'"]').attr("montagem_nome")),$('[step="'+(i+1)+'"]').length>1?($("#lbl_proximo").html($('[step="'+(i+2)+'"]').attr("montagem_nome")),$("#lbl_proximo").html("Próximo")):$("#lbl_proximo").html("Finalizar"),$(".tab")[i+1]==null?controller.montagem.finalizar(r):(r.montagem[i+1].max==1&&$("#tab"+(i+1)+" .toolbar").hide(),controller.adicionar.set(r),myApp.showTab("#tab"+(i+1)),r.montagem[i+1].max>1&&$("#complemento_nome").append('<div class="selecione">Seleciona até '+r.montagem[i+1].max+" itens<\/div>")),$("#complemento_nome").html($("[complemento_nome]:visible").attr("complemento_nome"))):controller.adicionar.set(r);creait.resize()},finalizar:function(n){n.agrupamento="";n.agrupamentoid="";n.imagens=[];n.montagens=[];var t=0;$(n.montagem).each(function(i,r){var u={montagem_id:r.id,preco:r.preco,produtos:[]};$(r.complemento).each(function(i,r){r.selecionado==!0&&(n.preco==null&&(n.preco=0),n.preco+=r.preco_montagem_desconto,n.agrupamento==null&&(n.agrupamento="",n.agrupamentoid=""),t=t+1,n.agrupamento+=" + "+r.nome,n.agrupamentoid+=r.id+",",n.imagens.push({icone:r.icone==""?null:r.icone}),n.redirect_adicionar="montagem",u.produtos.push({preco:r.preco_montagem_desconto,produto_id:r.product_id,external_id:r.external_id,nome:r.nome,nome:r.nome}));r.selecionado=!1});u.produtos.length>0&&n.montagens.push(u)});controller.adicionar.set(n);creait.redirect("adicionar");creait.resize()},value:[]};controller.pagamento={init:function(n){var t=controller.busca.get(),i;if(controller.busca.get().grupo_do_pagamento.length==1&&controller.busca.get().grupo_do_pagamento[0].pagamento.length==1){if(i={pagamento_id:t.grupo_do_pagamento[0].pagamento[0].id,nome:t.grupo_do_pagamento[0].pagamento[0].nome,external_id:t.grupo_do_pagamento[0].pagamento[0].external_id,transacao:t.grupo_do_pagamento[0].pagamento[0].transacao},controller.pagamento.set(i),controller.login.get()==null)return creait.redirect("cadastro"),"cadastro";if(controller.filial.get()!=null&&controller.endereco.get()==null)if(t.delivery==!0&&t.balcao==!0)creait.redirect("/");else{if(t.delivery==!0)return creait.redirect("endereco","to=pagamento"),"endereco?to=pagamento";if(t.balcao==!0)return creait.redirect("filial"),"filial"}else return i.transacao==4?controller.cartao.get()==null?(creait.redirect("cartao"),"cartao"):(creait.redirect(controller.busca.get().balcao?"confirmarPedido":"confirmar"),controller.busca.get().balcao?"confirmarPedido":"confirmar"):(creait.redirect(controller.busca.get().balcao?"confirmarPedido":"confirmar"),controller.busca.get().balcao?"confirmarPedido":"confirmar")}if(biblioteca.get("pagamento_no_final",!1))return creait.redirect("confirmar"),"confirmar";t.carrinho=controller.carrinho.get();controller.carrinho.change(t.carrinho);n(t,function(){$$("[pagamento_id]").click(function(){var i=this,n;n={pagamento_id:$(this).attr("pagamento_id"),nome:$(this).find(".fontextra").text(),external_id:$(i).attr("external_id"),transacao:parseInt($(i).attr("transacao"),10)};controller.pagamento.set(n);controller.login.get()==null?creait.redirect("cadastro"):controller.filial.get()!=null&&controller.endereco.get()==null?t.delivery==!0&&t.balcao==!0?creait.redirect("/"):t.delivery==!0?creait.redirect("endereco","to=pagamento"):t.balcao==!0&&creait.redirect("filial"):n.transacao==4?controller.cartao.get()==null?creait.redirect("cartao"):creait.redirect(controller.busca.get().balcao?"confirmarPedido":"confirmar"):creait.redirect(controller.busca.get().balcao?"confirmarPedido":"confirmar")})})},get:function(){return window.localStorage.pagamento==null?null:JSON.parse(window.localStorage.pagamento)},set:function(n){window.localStorage.pagamento=JSON.stringify(n)}};controller.pedido={init:function(n){var i=controller.login.get(),t={};creait.get("pedido?cliente_id="+i.id,null,function(i){t.compra=i;n(t,function(){})})},get:function(){return window.localStorage.pedidos==null?null:JSON.parse(window.localStorage.pedidos)},set:function(n){window.localStorage.pedidos=JSON.stringify(n)}};controller.perfil={init:function(n){n({},function(){controller.login.get()!=null&&($("#nomePerfil").val(controller.login.get().nome),$("#emailPerfil").val(controller.login.get().email),$("#telefonePerfil").val(controller.login.get().phone),$("#enderecoPerfil").val(controller.login.get().endereco),$("#numeroPerfil").val(controller.login.get().numero),$("#complementoPerfil").val(controller.login.get().complemento),$("#idPerfil").val(controller.login.get().id));$$("#btn_att").click(function(){creait.post("pessoas",myApp.formToJSON("formatt"),function(n){controller.login.set(n);alert("atualizado com sucesso")})})})}};controller.premium={init:function(n){creait.get("assinar",{},function(t){var i={};i.cartao=t;i.url=controller.layout.get().url;n(i,function(){creait.loader(!1);var n=null;Payment.formatCardExpiry(document.querySelector("#expiracao_input"));Payment.formatCardCVC(document.querySelector("#cvv"));Payment.formatCardNumber(document.querySelector("#cardnumber_input"));$$("#cardnumber_input").keyup(function(){var t=$(this).val();n=Payment.fns.cardType(t);$('[name="bandeira"]').val(n);$("#brand").attr("src","icons/bandeiras/"+n+".svg");$("#brand").css("display","block")});$$("#btn_savar_cartao").click(function(){$("#cardnumber_input").toggleInputError(!Payment.fns.validateCardNumber($("#cardnumber_input").val()),"Cartão esta inválido");$("#nome_input").toggleInputError($("#nome_input").val()=="","Nome obrigatório");$("#expiracao_input").toggleInputError(!($("#expiracao_input").val().split("/").length==2&&Payment.fns.validateCardExpiry($("#expiracao_input").val().split("/")[0],$("#expiracao_input").val().split("/")[1])),"Data inválida");$("#cvv").toggleInputError(!Payment.fns.validateCardCVC($("#cvv").val()),"CCV Inváligo");$("#documento").toggleInputError($("#documento").val()=="","CPF ou CNPJ inválido");var n=myApp.formToJSON("formcartao");$("formcartao .has-error").length==0&&($("input[type=checkbox]").is(":checked")?(creait.loader(!0,"Estamos processando o pagamento"),creait.post("assinar",n,function(n){creait.loader(!1);n.id=="authorized"?(n.cvv=null,localStorage.removeItem("filial_id"),localStorage.removeItem("filiais"),localStorage.removeItem("carrinho"),localStorage.removeItem("adicionar"),creait.redirect("bemvindo"),setTimeout(function(){localStorage.removeItem("layout")},1e3)):myApp.alert("Oops, ocorreu um erro",n.mensagem)})):myApp.alert("Você precisa aceitar os termos de uso para continuar","Atenção"))})})})},get:function(){return window.localStorage.cartao==null?null:JSON.parse(window.localStorage.cartao)},set:function(n){window.localStorage.cartao=n==null?n:JSON.stringify(n)}};controller.produto={init:function(n,t){if(controller.busca.get()==null)return window.location="/",null;if(t.id!=null&&controller.produto.set($(controller.busca.get().tipos).filter(function(n,i){return i.id==t.id})[0]),controller.produto.get()!=null){var i=controller.produto.get();controller.carrinho.change(i);n(i,function(){controller.login.get()!=null&&controller.login.get().perfil_id==3&&($(".icologin").hide(),$(".link.icon-only.open-panel").hide());controller.carrinho.get()==null?($(".panel_carrinho").hide(),$('[data-page="produto"].page').removeClass("carrinho_open")):$('[data-page="produto"].page').addClass("carrinho_open");(controller.login.get()==null||controller.login.get().perfil_id!=1&&controller.login.get().perfil_id!=4)&&($("#novo_produto").hide(),$(".swipeout").removeClass("swipeout"),$(".swipeout-actions-right").remove());$(".produtoli:visible").click(function(){creait.redirect($(this).attr("link"),"id="+$(this).attr("produto_id")+"&regiao="+controller.busca.get().id)});controller.carrinho.get()==null?($(".panel_carrinho").hide(),$('[data-page="categoria"]').removeClass("panel_carrinho")):$('[data-page="categoria"]').addClass("panel_carrinho");creait.resize();setTimeout(function(){creait.resize()},500);setTimeout(function(){creait.resize()},1e3);$(".produtoli[caracteristicas]").show();$(".produtoli[caracteristicas]").each(function(n,t){if(controller.layout.get().length>0){var i=!1;$(controller.layout.get().caracteristicas).each(function(n,r){$(t).attr("caracteristicas")!=""&&$($(t).attr("caracteristicas").split(",")).each(function(n,t){r.id==t&&(i=r.selecionado)})});i||$(t).hide()}})})}else return"categoria"},get:function(){return controller.produto.memory},set:function(n){controller.produto.memory=n},memory:null};controller.reservar={init:function(n){n({},function(){$$("#btn_sign_up").click(function(){$("#nome_input").toggleInputError($("#nome_input").val()=="","Informe o seu nome");$("#email_input").toggleInputError($("#email_input").val()==""||!creait.isEmail($("#email_input").val()),"Email inválido");$("#telefone_input").toggleInputError($("#telefone_input").val()==""||!creait.isPhone($("#telefone_input").val()),"Informe o seu telefone");$("#password_input").toggleInputError($("#nome_input").val()==""||$("#password_input").val().length<6,"A senha deve ter no minimo 6 caracteres");$("#password_confirmar_input").toggleInputError($("#password_input").val()!=$("#password_confirmar_input").val(),"A confirmação da senha esta errada");$("formcadastro .has-error").length==0&&creait.post("pessoas",myApp.formToJSON("formcadastro"),function(n){n.erro==null?(controller.login.set(n),controller.carrinho.get()!=null?controller.endereco.get()==null?controller.layout.get().balcao&&controller.layout.get().delivery?creait.redirect("endereco"):controller.busca.get().balcao?creait.redirect("filial"):creait.redirect("endereco"):controller.cartao.get()==null&&controller.pagamento.get()!=null&&controller.pagamento.get().transacao==4?creait.redirect("cartao"):controller.login.get().perfil_id==5?creait.redirect("cliente"):creait.redirect("pagamento"):creait.redirect("categoria")):myApp.alert(n.erro,"Atenção")})})})}};controller.layout={get:function(){return localStorage.getItem("layout")==null?null:JSON.parse(localStorage.layout)},set:function(n){localStorage.layout=JSON.stringify(n)},private:null};controller.busca={init:function(n){n({},function(){function n(){var i=$("#pac-input").val(),n=i.replace(/\D/g,""),t;n!=""&&(t=/^[0-9]{8}$/,t.test(n)?($.ajax({type:"GET",url:"http://viacep.com.br/ws/"+n+"/json",dataType:"json",contentType:!1,processData:!1,success:function(n){$("#enderecos").text(n.logradouro+" - "+n.bairro+" - "+n.localidade);$("#numero").val(n.complemento);$("#pac-input").val(n.cep);$("#cidade").val(n.localidade)},error:function(n){$("html").html(n.responseText)}}),$("#modal_endereco").css("display","block")):myApp.alert("CEP invalido!","Atenção!"))}$$("#btn_search").click(function(){n()});$$("#pac-input").keyup(function(){this.value.length==8&&n()});$$("#btn_search_gps").click(function(){controller.busca.get()==null?navigator.geolocation?navigator.geolocation.getCurrentPosition(function(n){var t=[],i=n.coords.latitude,r=n.coords.longitude;t[0]=i;t[1]=r;controller.corfirmarEndereco.set(t);$.ajax({type:"GET",url:"http://maps.googleapis.com/maps/api/geocode/json?latlng="+i+","+r,dataType:"json",contentType:!1,processData:!1,success:function(n){$("#enderecos").text(n.results[0].address_components[1].short_name);$("#numero").val(n.results[0].address_components[0].long_name);$("#pac-input").val(n.results[0].address_components[7].long_name);$("#cidade").val(n.results[0].address_components[5].long_name)},error:function(){}});$("#modal_endereco").css("display","block")},function(){console.log("Erro ao encontrar a possição")}):alert("Parece que Geolocation, que é necessário para esta página, não está ativado em seu navegador. Use um navegador que o suporte."):creait.redirect("categoria")});$$("#btn_voltar").click(function(){$("#modal_endereco").css("display","none")});$$("#btn_confimar").click(function(){var n={};n.number=$("#numero").val();n.number==""?myApp.alert("Preencha o numero!","Atenção!",function(){}):(myApp.showPreloader("Buscando Cardápio"),$("#modal_endereco").css("display","none"),n.active=!0,n.cep=$("#pac-input").val(),n.street=$("#enderecos").html(),n.complement=$("#complemento").val(),n.city=$("#cidade").val(),n.lat=$("#lat").val(),n.lng=$("#lng").val(),controller.login.get()==null?controller.endereco.set(n):(n.pessoa_id=controller.login.get().id,creait.post("endereco",n,function(){})),creait.redirect("categoria"))})})},get:function(){return controller.busca.memory==null?window.localStorage.filiais==null?null:JSON.parse(window.localStorage.filiais):controller.busca.memory},set:function(n){try{window.localStorage.filiais=n==null?n:JSON.stringify(n);controller.busca.memory=null}catch(t){controller.busca.memory=n==null?n:n}},memory:null};controller.erroEndereco={init:function(n){n({},function(){})},get:function(){return window.localStorage.CEP==null?null:JSON.parse(window.localStorage.CEP)},set:function(n){window.localStorage.CEP=n==null?n:JSON.stringify(n)}};controller.index={init:function(n){creait.get("filiais",null,function(t){n(t,function(){controller.login.get()==null&&creait.redirect("categoria")})})}};$(window).resize(function(){window.resizeTo(425,660)});controller.senha={init:function(n,t){n({},function(){$("#btn_alterarsenha").click(function(){$("#lembrar_senha").val()==$("#lembar_senha_confirmar").val()||$("#lembrar_senha").val()!=""&&$("#lembar_senha_confirmar").val()!=""?creait.post("lembrar?token="+t.token+"&senha="+$("#lembrar_senha").val(),null,function(){creait.redirect("login")}):myApp.alert("A confirmação da senha está errada")})})}};controller.servico={init:function(n){var i=controller.login.get(),t={produto:{},tipos:[],filiais:[],semanas:[{txt:"seg",label:"Segunda Feira",inicio:"",termino:""},{txt:"ter",label:"Terça Feira",inicio:"",termino:""},{txt:"qua",label:"Quarta Feira",inicio:"",termino:""},{txt:"qui",label:"Quinta Feira",inicio:"",termino:""},{txt:"sex",label:"Sexta Feira",inicio:"",termino:""},{txt:"sab",label:"Sabado",inicio:"",termino:""},{txt:"dom",label:"Domingo",inicio:"",termino:""},]};creait.get("produto?id="+i.id,{},function(i){var f,r,u,e;f=controller.login.get();f.active=i.ativo;controller.login.set(f);i.ativo==!0&&(r=controller.login.get(),r.active=!0,controller.login.set(r),$(i.filiais).each(function(n,t){i.produto!=null&&$(i.produto.filial_produto).each(function(n,i){t.id==i.filial_id&&(t.selected="selected")})}),$(i.caracteristicas).each(function(n,t){i.produto!=null&&$(i.produto.produto_caracteristica).each(function(n,i){t.id==i.caracteristica_id&&(t.selected="selected")})}),i.produto==null?(i.produto={},i.produto.nome=controller.login.get().nome):(i.filial_produto_list=JSON.stringify(i.produto.filial_produto),r=controller.login.get(),r.produto_id=i.produto.id,controller.login.set(r)),u=i.produto.agenda,u==null&&(u={}),$(t.semanas).each(function(n,t){t.inicio=u[t.txt+"_inicio"];t.termino=u[t.txt+"_fim"]}),i.produto.observacao!=null&&(e=JSON.parse(i.produto.observacao),t.graduacao=e.graduacao,t.especialidade=e.especialidade),i.produto.preco!=null&&(t.preco=i.produto.preco.toString().replace(".",",")),t.caracteristicas=i.caracteristicas,t.produto=i.produto,t.tipos=i.tipos,t.filiais=i.filiais);n(t,function(){i.ativo!=!0?($(".aguardando_liberacao").show(),$("formcalendario").remove()):($('[name="foto_produto"]')[0].addEventListener("change",function(n){readimg(n,function(n){$('[name="icone_itype"]').val(n);$(".calendario_foto").html("");$(".calendario_foto").css("background-image",'url("'+n+'")')})},!1),$("#btn_calendario").click(function(){var n=creait.getForm("formcalendario");n.periodo=$('[name="tipo_id"]').attr("periodo");$('[name="nome"]').toggleInputError(n.nome=="","Informe seu nome");$('[name="graduacao"]').toggleInputError(n.graduacao=="","Informe uma graduação");$('[name="especialidade"]').toggleInputError(n.especialidade=="","Informe uma especialidade");$('[name="tipo_id"]').toggleInputError(n.tipo_id=="","Informe um tipo de serviço");$('[name="filiais_id"]').toggleInputError(n.filiais_id.length==0,"Informe o local de atendimento");$('[name="caracteristicas_id"]').toggleInputError(n.caracteristicas_id.length==0,"Informe a caracteristica");$('[name="preco"]').toggleInputError(n.preco=="","Informe o VALOR HORA do seu serviço");$("#panel_185").toggleInputError($(".content_horario.active").length==0,"Selecione pelo menos um dia da semana");$(t.semanas).each(function(t,i){$('[name="agenda.'+i.txt+'_inicio"]').closest(".content_horario.active").length!=0?($('[name="agenda.'+i.txt+'_inicio"]').toggleInputError(n["agenda."+i.txt+"_inicio"]>n["agenda."+i.txt+"_fim"],"O horário de inicio deve ser maior que o termino"),$('[name="agenda.'+i.txt+'_fim"]').toggleInputError(n["agenda."+i.txt+"_fim"]=="","Informe a data de termino"),$('[name="agenda.'+i.txt+'_inicio"]').toggleInputError(n["agenda."+i.txt+"_inicio"]=="","Informe a data de inicio")):(n["agenda."+i.txt+"_inicio"]=null,n["agenda."+i.txt+"_fim"]=null)});$('[data-page="servico"] .has-error').length==0&&(n.observacao=JSON.stringify({graduacao:n.graduacao,especialidade:n.especialidade,minicurriculo:n.minicurriculo}),n.preco=n.preco.replace(/\./g,"").replace(/\,/g,"."),creait.post("produto",n,function(t){var i=controller.login.get();i.produto_id=t.id;i.filial_id=n.filiais_id.length==0?null:n.filiais_id[0];controller.login.set(i);$('[name="id"]').val(t.id);$('[name="agenda.id"]').val(t.agenda.id);creait.redirect("consulta")}))}))})})},get:function(){return window.localStorage.pedidos==null?null:JSON.parse(window.localStorage.pedidos)},set:function(n){window.localStorage.pedidos=JSON.stringify(n)}};controller.trabalhar={init:function(n){creait.get("tipos",{},function(t){n({tipos:t},function(){$$("#btn_trabalhar").click(function(){var n=myApp.formToJSON("formtrabalhar");$('[name="nome"]').toggleInputError(n.nome=="","Informe o seu nome");$('[name="photo"]').toggleInputError(n.photo_itype=="","Obrigatório");$('[name="comprovante"]').toggleInputError(n.comprovante_itype=="","Obrigatório");$('[name="antecedentes"]').toggleInputError(n.antecedente_itype=="","Obrigatório");$('[name="BankCode"]').toggleInputError(n.BankCode=="","Informe o seu banco");$('[name="especialidade_id"]').toggleInputError(n.especialidade_id=="","Informe sua especialidade");$('[name="rg_image"]').toggleInputError(n.rg_image_itype=="","Obrigatório");$('[name="email"]').toggleInputError(n.email=="","Informe o seu email profissional");$('[name="tel"]').toggleInputError(n.tel=="","Informe um telefone");$('[name="birthday"]').toggleInputError(n.birthday=="","Informe a data de nascimento");$('[name="cpf"]').toggleInputError(n.cpf=="","Informe o numero do seu cpf");$('[name="rg"]').toggleInputError(n.rg=="","Informe o numero do seu rg");$('[name="phone"]').toggleInputError(n.phone=="","Informe seu telefone");$('[name="password"]').toggleInputError(n.password=="","Informe uma senha");$("#aceite").toggleInputError($("#aceite:checked").length==0,"Para continuar você precisa aceitar os termos de uso");$("formtrabalhar .has-error").length==0&&(n.comissao=10,creait.post("trabalhar",n,function(n){n.erro==null?(controller.login.set(n),controller.carrinho.get()!=null?controller.endereco.get()==null?controller.layout.get().balcao&&controller.layout.get().delivery?creait.redirect("endereco"):controller.busca.get().balcao?creait.redirect("filial"):creait.redirect("endereco"):controller.cartao.get()==null&&controller.pagamento.get()!=null&&controller.pagamento.get().transacao==4?creait.redirect("cartao"):controller.login.get().perfil_id==5?creait.redirect("cliente"):creait.redirect("pagamento"):creait.redirect("categoria")):myApp.alert(n.erro,"Atenção")}))})})})},get:function(){return window.localStorage.pedidos==null?null:JSON.parse(window.localStorage.pedidos)},set:function(n){window.localStorage.pedidos=JSON.stringify(n)}};